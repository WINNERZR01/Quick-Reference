<!doctype html>
<html lang="en" data-color-mode="dark">
<head>
<meta charset="utf-8">
<title>&#x3C;h1 align &#x26;  index cheatsheet &#x26;  Quick Reference</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta description="为开发人员分享快速参考备忘单。">
<meta keywords="Quick,Reference,cheatsheet,index">
<link rel="icon" href="data:image/svg+xml,%3Csvg%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%221em%22%20width%3D%221em%22%3E%20%3Cpath%20d%3D%22m21.66%2010.44-.98%204.18c-.84%203.61-2.5%205.07-5.62%204.77-.5-.04-1.04-.13-1.62-.27l-1.68-.4c-4.17-.99-5.46-3.05-4.48-7.23l.98-4.19c.2-.85.44-1.59.74-2.2%201.17-2.42%203.16-3.07%206.5-2.28l1.67.39c4.19.98%205.47%203.05%204.49%207.23Z%22%20fill%3D%22%23c9d1d9%22%2F%3E%20%3Cpath%20d%3D%22M15.06%2019.39c-.62.42-1.4.77-2.35%201.08l-1.58.52c-3.97%201.28-6.06.21-7.35-3.76L2.5%2013.28c-1.28-3.97-.22-6.07%203.75-7.35l1.58-.52c.41-.13.8-.24%201.17-.31-.3.61-.54%201.35-.74%202.2l-.98%204.19c-.98%204.18.31%206.24%204.48%207.23l1.68.4c.58.14%201.12.23%201.62.27Zm2.43-8.88c-.06%200-.12-.01-.19-.02l-4.85-1.23a.75.75%200%200%201%20.37-1.45l4.85%201.23a.748.748%200%200%201-.18%201.47Z%22%20fill%3D%22%23228e6c%22%20%2F%3E%20%3Cpath%20d%3D%22M14.56%2013.89c-.06%200-.12-.01-.19-.02l-2.91-.74a.75.75%200%200%201%20.37-1.45l2.91.74c.4.1.64.51.54.91-.08.34-.38.56-.72.56Z%22%20fill%3D%22%23228e6c%22%20%2F%3E%20%3C%2Fsvg%3E" type="image/svg+xml">
<link rel="stylesheet" href="..\..\style\style.css">
<link rel="stylesheet" href="..\..\style\katex.css">
</head>
<body><nav class="header-nav"><div class="max-container"><a href="..\..\index.html" class="logo"><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" height="1em" width="1em">
  <path d="m21.66 10.44-.98 4.18c-.84 3.61-2.5 5.07-5.62 4.77-.5-.04-1.04-.13-1.62-.27l-1.68-.4c-4.17-.99-5.46-3.05-4.48-7.23l.98-4.19c.2-.85.44-1.59.74-2.2 1.17-2.42 3.16-3.07 6.5-2.28l1.67.39c4.19.98 5.47 3.05 4.49 7.23Z" fill="#c9d1d9"></path>
  <path d="M15.06 19.39c-.62.42-1.4.77-2.35 1.08l-1.58.52c-3.97 1.28-6.06.21-7.35-3.76L2.5 13.28c-1.28-3.97-.22-6.07 3.75-7.35l1.58-.52c.41-.13.8-.24 1.17-.31-.3.61-.54 1.35-.74 2.2l-.98 4.19c-.98 4.18.31 6.24 4.48 7.23l1.68.4c.58.14 1.12.23 1.62.27Zm2.43-8.88c-.06 0-.12-.01-.19-.02l-4.85-1.23a.75.75 0 0 1 .37-1.45l4.85 1.23a.748.748 0 0 1-.18 1.47Z" fill="#228e6c"></path>
  <path d="M14.56 13.89c-.06 0-.12-.01-.19-.02l-2.91-.74a.75.75 0 0 1 .37-1.45l2.91.74c.4.1.64.51.54.91-.08.34-.38.56-.72.56Z" fill="#228e6c"></path>
</svg>
<span class="title">Quick Reference</span></a><div class="menu"><a href="https://github.com/jaywcjlove/reference/blob/main/node_modules/micromark\readme.md" class="" target="__blank"><svg viewBox="0 0 36 36" fill="currentColor" height="1em" width="1em"><path d="m33 6.4-3.7-3.7a1.71 1.71 0 0 0-2.36 0L23.65 6H6a2 2 0 0 0-2 2v22a2 2 0 0 0 2 2h22a2 2 0 0 0 2-2V11.76l3-3a1.67 1.67 0 0 0 0-2.36ZM18.83 20.13l-4.19.93 1-4.15 9.55-9.57 3.23 3.23ZM29.5 9.43 26.27 6.2l1.85-1.85 3.23 3.23Z"></path><path fill="none" d="M0 0h36v36H0z"></path></svg><span>编辑</span></a><button id="darkMode" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="light" height="1em" width="1em">
  <path d="M6.995 12c0 2.761 2.246 5.007 5.007 5.007s5.007-2.246 5.007-5.007-2.246-5.007-5.007-5.007S6.995 9.239 6.995 12zM11 19h2v3h-2zm0-17h2v3h-2zm-9 9h3v2H2zm17 0h3v2h-3zM5.637 19.778l-1.414-1.414 2.121-2.121 1.414 1.414zM16.242 6.344l2.122-2.122 1.414 1.414-2.122 2.122zM6.344 7.759 4.223 5.637l1.415-1.414 2.12 2.122zm13.434 10.605-1.414 1.414-2.122-2.122 1.414-1.414z"></path>
</svg>
<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="dark" height="1em" width="1em">
  <path d="M12 11.807A9.002 9.002 0 0 1 10.049 2a9.942 9.942 0 0 0-5.12 2.735c-3.905 3.905-3.905 10.237 0 14.142 3.906 3.906 10.237 3.905 14.143 0a9.946 9.946 0 0 0 2.735-5.119A9.003 9.003 0 0 1 12 11.807z"></path>
</svg>
</button><script>
  const LOCAL_NANE = '_dark_mode_theme_'
  const rememberedValue = localStorage.getItem(LOCAL_NANE);
  if (rememberedValue && ['light', 'dark'].includes(rememberedValue)) {
    document.documentElement.setAttribute('data-color-mode', rememberedValue);
  }
  const button = document.querySelector('#darkMode');
  button.onclick = () => {
    const theme = document.documentElement.dataset.colorMode;
    const mode = theme === 'light' ? 'dark' : 'light';
    document.documentElement.setAttribute('data-color-mode', mode);
    localStorage.setItem(LOCAL_NANE, mode);
  }
</script><a href="https://github.com/jaywcjlove/reference" class="" target="__blank"><svg viewBox="0 0 16 16" fill="currentColor" height="1em" width="1em"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a></div></div></nav><div class="wrap h1body-exist max-container"><header class="wrap-header h1wrap"><h1 align="center" id="--"><a aria-hidden="true" tabindex="-1" href="#--"><span class="icon icon-link"></span></a>
  <img src="https://raw.githubusercontent.com/micromark/micromark/2e476c9/logo.svg?sanitize=true" alt="micromark">
</h1><div class="wrap-body">
<p><a href="https://github.com/micromark/micromark/actions"><img src="https://github.com/micromark/micromark/workflows/main/badge.svg" alt="Build"></a>
<a href="https://codecov.io/github/micromark/micromark"><img src="https://img.shields.io/codecov/c/github/micromark/micromark.svg" alt="Coverage"></a>
<a href="https://www.npmjs.com/package/micromark"><img src="https://img.shields.io/npm/dm/micromark.svg" alt="Downloads"></a>
<a href="https://bundlephobia.com/result?p=micromark"><img src="https://img.shields.io/bundlephobia/minzip/micromark.svg" alt="Size"></a>
<a href="https://opencollective.com/unified"><img src="https://opencollective.com/unified/sponsors/badge.svg" alt="Sponsors"></a>
<a href="https://opencollective.com/unified"><img src="https://opencollective.com/unified/backers/badge.svg" alt="Backers"></a>
<a href="https://github.com/micromark/micromark/discussions"><img src="https://img.shields.io/badge/chat-discussions-success.svg" alt="Chat"></a></p>
<p>The smallest CommonMark compliant markdown parser with positional info and
concrete tokens.</p>
</div></header><div class="menu-tocs"><div class="menu-btn"><svg aria-hidden="true" fill="currentColor" height="1em" width="1em" viewBox="0 0 16 16" version="1.1" data-view-component="true">
  <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
</svg></div><div class="menu-modal"><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#feature-highlights">Feature highlights</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#when-to-use-this">When to use this</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#intro">Intro</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#contents">Contents</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#install">Install</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#use">Use</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#api">API</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#micromarkvalue-encoding-options">micromark(value[, encoding][, options])</a><a aria-hidden="true" class="leve5 tocs-link" data-num="5" href="#parameters">Parameters</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#value">value</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#encoding">encoding</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#optionsdefaultlineending">options.defaultLineEnding</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#optionsallowdangeroushtml">options.allowDangerousHtml</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#optionsallowdangerousprotocol">options.allowDangerousProtocol</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#optionsextensions">options.extensions</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#optionshtmlextensions">options.htmlExtensions</a><a aria-hidden="true" class="leve5 tocs-link" data-num="5" href="#returns">Returns</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#streamoptions">stream(options?)</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#extensions">Extensions</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#list-of-extensions">List of extensions</a><a aria-hidden="true" class="leve4 tocs-link" data-num="4" href="#community-extensions">Community extensions</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#syntaxextension">SyntaxExtension</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#htmlextension">HtmlExtension</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#extending-markdown">Extending markdown</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#creating-a-micromark-extension">Creating a micromark extension</a><a aria-hidden="true" class="leve4 tocs-link" data-num="4" href="#prerequisites">Prerequisites</a><a aria-hidden="true" class="leve4 tocs-link" data-num="4" href="#extension-basics">Extension basics</a><a aria-hidden="true" class="leve4 tocs-link" data-num="4" href="#case-variables">Case: variables</a><a aria-hidden="true" class="leve5 tocs-link" data-num="5" href="#setup">Setup</a><a aria-hidden="true" class="leve5 tocs-link" data-num="5" href="#syntax-extension">Syntax extension</a><a aria-hidden="true" class="leve5 tocs-link" data-num="5" href="#html-extension">HTML extension</a><a aria-hidden="true" class="leve5 tocs-link" data-num="5" href="#further-exercises">Further exercises</a><a aria-hidden="true" class="leve4 tocs-link" data-num="4" href="#case-turn-off-constructs">Case: turn off constructs</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#architecture">Architecture</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#overview">Overview</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#preprocess">Preprocess</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#parse">Parse</a><a aria-hidden="true" class="leve4 tocs-link" data-num="4" href="#content-types">Content types</a><a aria-hidden="true" class="leve4 tocs-link" data-num="4" href="#constructs">Constructs</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#postprocess">Postprocess</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#compile">Compile</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#examples">Examples</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#github-flavored-markdown-gfm">GitHub flavored markdown (GFM)</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#math">Math</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#syntax-tree">Syntax tree</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#markdown">Markdown</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#commonmark">CommonMark</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#grammar">Grammar</a><a aria-hidden="true" class="leve2 tocs-link" data-num="2" href="#project">Project</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#comparison">Comparison</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#micromark">micromark</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#remark">remark</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#marked">marked</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#markdown-it">markdown-it</a><a aria-hidden="true" class="leve6 tocs-link" data-num="6" href="#others">Others</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#test">Test</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#size--debug">Size &#x26; debug</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#version">Version</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#security">Security</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#contribute">Contribute</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#sponsor">Sponsor</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#origin-story">Origin story</a><a aria-hidden="true" class="leve3 tocs-link" data-num="3" href="#license">License</a></div></div><div class="h1wrap-body"><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="feature-highlights"><a aria-hidden="true" tabindex="-1" href="#feature-highlights"><span class="icon icon-link"></span></a>Feature highlights</h2><div class="wrap-body">
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" checked disabled> <strong><a href="#commonmark">compliant</a></strong> (100% to CommonMark)</li>
<li class="task-list-item"><input type="checkbox" checked disabled> <strong><a href="#list-of-extensions">extensions</a></strong> (<a href="https://github.com/micromark/micromark-extension-gfm">GFM</a>, <a href="https://github.com/micromark/micromark-extension-directive">directives</a>, <a href="https://github.com/micromark/micromark-extension-frontmatter">frontmatter</a>, <a href="https://github.com/micromark/micromark-extension-math">math</a>,
<a href="https://github.com/micromark/micromark-extension-mdxjs">MDX.js</a>)</li>
<li class="task-list-item"><input type="checkbox" checked disabled> <strong><a href="#security">safe</a></strong> (by default)</li>
<li class="task-list-item"><input type="checkbox" checked disabled> <strong><a href="#size--debug">small</a></strong> (smallest CM parser that exists)</li>
<li class="task-list-item"><input type="checkbox" checked disabled> <strong><a href="#test">robust</a></strong> (1800+ tests, 100% coverage, fuzz testing)</li>
</ul>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="when-to-use-this"><a aria-hidden="true" tabindex="-1" href="#when-to-use-this"><span class="icon icon-link"></span></a>When to use this</h2><div class="wrap-body">
<ul>
<li>If you <em>just</em> want to turn markdown into HTML (with maybe a few extensions)</li>
<li>If you want to do <em>really complex things</em> with markdown</li>
</ul>
<p>See <a href="#comparison">§ Comparison</a> for more info</p>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="intro"><a aria-hidden="true" tabindex="-1" href="#intro"><span class="icon icon-link"></span></a>Intro</h2><div class="wrap-body">
<p>micromark is a long awaited markdown parser.
It uses a <a href="https://github.com/micromark/common-markup-state-machine">state machine</a> to parse the entirety of markdown into concrete
tokens.
It’s the smallest 100% <a href="#commonmark">CommonMark</a> compliant markdown parser in JavaScript.
It was made to replace the internals of <a href="https://unifiedjs.com/explore/package/remark-parse/"><code>remark-parse</code></a>, the most
<a href="https://www.npmtrends.com/remark-parse-vs-marked-vs-markdown-it">popular</a> markdown parser.
Its API compiles to HTML, but its parts are made to be used separately, so as to
generate syntax trees (<a href="https://github.com/syntax-tree/mdast-util-from-markdown"><code>mdast-util-from-markdown</code></a>) or compile
to other output formats.</p>
<ul>
<li>to learn markdown, see this <a href="https://commonmark.org/help/">cheatsheet and tutorial</a></li>
<li>for more about us, see <a href="https://unifiedjs.com"><code>unifiedjs.com</code></a></li>
<li>for updates, see <a href="https://twitter.com/unifiedjs">Twitter</a></li>
<li>for questions, see <a href="https://github.com/micromark/micromark/discussions">Discussions</a></li>
<li>to help, see <a href="#contribute">contribute</a> or <a href="#sponsor">sponsor</a> below</li>
</ul>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="contents"><a aria-hidden="true" tabindex="-1" href="#contents"><span class="icon icon-link"></span></a>Contents</h2><div class="wrap-body">
<ul>
<li><a href="#install">Install</a></li>
<li><a href="#use">Use</a></li>
<li><a href="#api">API</a>
<ul>
<li><a href="#micromarkvalue-encoding-options"><code>micromark(value[, encoding][, options])</code></a></li>
<li><a href="#streamoptions"><code>stream(options?)</code></a></li>
</ul>
</li>
<li><a href="#extensions">Extensions</a>
<ul>
<li><a href="#list-of-extensions">List of extensions</a></li>
<li><a href="#syntaxextension"><code>SyntaxExtension</code></a></li>
<li><a href="#htmlextension"><code>HtmlExtension</code></a></li>
<li><a href="#extending-markdown">Extending markdown</a></li>
<li><a href="#creating-a-micromark-extension">Creating a micromark extension</a></li>
</ul>
</li>
<li><a href="#architecture">Architecture</a>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#preprocess">Preprocess</a></li>
<li><a href="#parse">Parse</a></li>
<li><a href="#postprocess">Postprocess</a></li>
<li><a href="#compile">Compile</a></li>
</ul>
</li>
<li><a href="#examples">Examples</a>
<ul>
<li><a href="#github-flavored-markdown-gfm">GitHub flavored markdown (GFM)</a></li>
<li><a href="#math">Math</a></li>
<li><a href="#syntax-tree">Syntax tree</a></li>
</ul>
</li>
<li><a href="#markdown">Markdown</a>
<ul>
<li><a href="#commonmark">CommonMark</a></li>
<li><a href="#grammar">Grammar</a></li>
</ul>
</li>
<li><a href="#project">Project</a>
<ul>
<li><a href="#comparison">Comparison</a></li>
<li><a href="#test">Test</a></li>
<li><a href="#size--debug">Size &#x26; debug</a></li>
<li><a href="#version">Version</a></li>
<li><a href="#security">Security</a></li>
<li><a href="#contribute">Contribute</a></li>
<li><a href="#sponsor">Sponsor</a></li>
<li><a href="#origin-story">Origin story</a></li>
<li><a href="#license">License</a></li>
</ul>
</li>
</ul>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="install"><a aria-hidden="true" tabindex="-1" href="#install"><span class="icon icon-link"></span></a>Install</h2><div class="wrap-body">
<p>This package is <a href="https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c">ESM only</a>.
In Node.js (version 12.20+, 14.14+, 16.0+, 18.0+), install with <a href="https://docs.npmjs.com/cli/install">npm</a>:</p>
<pre class="language-sh"><code class="language-sh code-highlight"><span class="code-line"><span class="token function">npm</span> <span class="token function">install</span> micromark
</span></code></pre>
<p>In Deno with <a href="https://esm.sh"><code>esm.sh</code></a>:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>micromark<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'https://esm.sh/micromark@3'</span>
</span></code></pre>
<p>In browsers with <a href="https://esm.sh"><code>esm.sh</code></a>:</p>
<pre class="language-html"><code class="language-html code-highlight"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
</span></span></span><span class="code-line"><span class="token script"><span class="token language-javascript">  <span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>micromark<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'https://esm.sh/micromark@3?bundle'</span>
</span></span></span><span class="code-line"><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
</span></code></pre>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="use"><a aria-hidden="true" tabindex="-1" href="#use"><span class="icon icon-link"></span></a>Use</h2><div class="wrap-body">
<p>Typical use (buffering):</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>micromark<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark'</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">micromark</span><span class="token punctuation">(</span><span class="token string">'## Hello, *world*!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre>
<p>Yields:</p>
<pre class="language-html"><code class="language-html code-highlight"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Hello, <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>em</span><span class="token punctuation">></span></span>world<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>em</span><span class="token punctuation">></span></span>!<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span></code></pre>
<p>You can pass extensions (in this case <a href="https://github.com/micromark/micromark-extension-gfm"><code>micromark-extension-gfm</code></a>):</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>micromark<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark'</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>gfm<span class="token punctuation">,</span> gfmHtml<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark-extension-gfm'</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token string">'* [x] contact@example.com ~~strikethrough~~'</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">micromark</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">gfm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">htmlExtensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">gfmHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</span></code></pre>
<p>Yields:</p>
<pre class="language-html"><code class="language-html code-highlight"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ul</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">checked</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mailto:contact@example.com<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>contact@example.com<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>del</span><span class="token punctuation">></span></span>strikethrough<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>del</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ul</span><span class="token punctuation">></span></span>
</span></code></pre>
<p>Streaming interface:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">fs</span> <span class="token keyword module">from</span> <span class="token string">'fs'</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>stream<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark/stream'</span>
</span><span class="code-line">
</span><span class="code-line">fs<span class="token punctuation">.</span><span class="token method function property-access">createReadStream</span><span class="token punctuation">(</span><span class="token string">'example.md'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> handleError<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">pipe</span><span class="token punctuation">(</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">pipe</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">stdout</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">handleError</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// Handle your error here!</span>
</span><span class="code-line">  <span class="token keyword control-flow">throw</span> error
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-exist"><div class="wrap-header h2wrap"><h2 id="api"><a aria-hidden="true" tabindex="-1" href="#api"><span class="icon icon-link"></span></a>API</h2><div class="wrap-body">
<p><code>micromark</code> core has two entries in its export map: <code>micromark</code> and
<code>micromark/stream</code>.</p>
<p><code>micromark</code> exports the following identifier: <code>micromark</code>.
<code>micromark/stream</code> exports the following identifier: <code>stream</code>.
There are no default exports.</p>
<p>The export map supports the endorsed
<a href="https://nodejs.org/api/packages.html#packages_resolving_user_conditions"><code>development</code> condition</a>.
Run <code>node --conditions development module.js</code> to get instrumented dev code.
Without this condition, production code is loaded.
See <a href="https://github.com/micromark/micromark#size--debug">§ Size &#x26; debug</a> for more info.</p>
</div></div><div class="h2wrap-body"><div class="wrap h3body-exist"><div class="wrap-header h3wrap"><h3 id="micromarkvalue-encoding-options"><a aria-hidden="true" tabindex="-1" href="#micromarkvalue-encoding-options"><span class="icon icon-link"></span></a><code>micromark(value[, encoding][, options])</code></h3><div class="wrap-body">
<p>Compile markdown to HTML.</p>
<h5 id="parameters"><a aria-hidden="true" tabindex="-1" href="#parameters"><span class="icon icon-link"></span></a>Parameters</h5>
<h6 id="value"><a aria-hidden="true" tabindex="-1" href="#value"><span class="icon icon-link"></span></a><code>value</code></h6>
<p>Markdown to parse (<code>string</code> or <code>Buffer</code>).</p>
<h6 id="encoding"><a aria-hidden="true" tabindex="-1" href="#encoding"><span class="icon icon-link"></span></a><code>encoding</code></h6>
<p><a href="https://nodejs.org/api/buffer.html#buffer_buffers_and_character_encodings">Character encoding</a> to understand <code>value</code> as when it’s a
<a href="https://nodejs.org/api/buffer.html"><code>Buffer</code></a> (<code>string</code>, default: <code>'utf8'</code>).</p>
<h6 id="optionsdefaultlineending"><a aria-hidden="true" tabindex="-1" href="#optionsdefaultlineending"><span class="icon icon-link"></span></a><code>options.defaultLineEnding</code></h6>
<p>Value to use for line endings not in <code>value</code> (<code>string</code>, default: first line
ending or <code>'\n'</code>).</p>
<p>Generally, micromark copies line endings (<code>'\r'</code>, <code>'\n'</code>, <code>'\r\n'</code>) in the
markdown document over to the compiled HTML.
In some cases, such as <code>> a</code>, CommonMark requires that extra line endings are
added: <code>&#x3C;blockquote>\n&#x3C;p>a&#x3C;/p>\n&#x3C;/blockquote></code>.</p>
<h6 id="optionsallowdangeroushtml"><a aria-hidden="true" tabindex="-1" href="#optionsallowdangeroushtml"><span class="icon icon-link"></span></a><code>options.allowDangerousHtml</code></h6>
<p>Whether to allow embedded HTML (<code>boolean</code>, default: <code>false</code>).
See <a href="#security">§ Security</a>.</p>
<h6 id="optionsallowdangerousprotocol"><a aria-hidden="true" tabindex="-1" href="#optionsallowdangerousprotocol"><span class="icon icon-link"></span></a><code>options.allowDangerousProtocol</code></h6>
<p>Whether to allow potentially dangerous protocols in links and images (<code>boolean</code>,
default: <code>false</code>).
URLs relative to the current protocol are always allowed (such as, <code>image.jpg</code>).
For links, the allowed protocols are <code>http</code>, <code>https</code>, <code>irc</code>, <code>ircs</code>, <code>mailto</code>,
and <code>xmpp</code>.
For images, the allowed protocols are <code>http</code> and <code>https</code>.
See <a href="#security">§ Security</a>.</p>
<h6 id="optionsextensions"><a aria-hidden="true" tabindex="-1" href="#optionsextensions"><span class="icon icon-link"></span></a><code>options.extensions</code></h6>
<p>Array of syntax extensions (<a href="#syntaxextension"><code>Array&#x3C;SyntaxExtension></code></a>,
default: <code>[]</code>).
See <a href="#list-of-extensions">§ Extensions</a>.</p>
<h6 id="optionshtmlextensions"><a aria-hidden="true" tabindex="-1" href="#optionshtmlextensions"><span class="icon icon-link"></span></a><code>options.htmlExtensions</code></h6>
<p>Array of HTML extensions (<a href="#htmlextension"><code>Array&#x3C;HtmlExtension></code></a>, default:
<code>[]</code>).
See <a href="#list-of-extensions">§ Extensions</a>.</p>
<h5 id="returns"><a aria-hidden="true" tabindex="-1" href="#returns"><span class="icon icon-link"></span></a>Returns</h5>
<p><code>string</code> — Compiled HTML.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="streamoptions"><a aria-hidden="true" tabindex="-1" href="#streamoptions"><span class="icon icon-link"></span></a><code>stream(options?)</code></h3><div class="wrap-body">
<p>Streaming interface of micromark.
Compiles markdown to HTML.
<code>options</code> are the same as the buffering API above.
Note that some of the work to parse markdown can be done streaming, but in the
end buffering is required.</p>
<p>micromark does not handle errors for you, so you must handle errors on whatever
streams you pipe into it.
As markdown does not know errors, <code>micromark</code> itself does not emit errors.</p>
</div></div></div></div></div><div class="wrap h2body-exist"><div class="wrap-header h2wrap"><h2 id="extensions"><a aria-hidden="true" tabindex="-1" href="#extensions"><span class="icon icon-link"></span></a>Extensions</h2><div class="wrap-body">
<p>micromark supports extensions.
There are two types of extensions for micromark:
<a href="#syntaxextension"><code>SyntaxExtension</code></a>,
which change how markdown is parsed, and <a href="#htmlextension"><code>HtmlExtension</code></a>,
which change how it compiles.
They can be passed in <a href="#optionsextensions"><code>options.extensions</code></a> or
<a href="#optionshtmlextensions"><code>options.htmlExtensions</code></a>, respectively.</p>
<p>As a user of extensions, refer to each extension’s readme for more on how to use
them.
As a (potential) author of extensions, refer to
<a href="#extending-markdown">§ Extending markdown</a> and
<a href="#creating-a-micromark-extension">§ Creating a micromark extension</a>.</p>
</div></div><div class="h2wrap-body"><div class="wrap h3body-exist"><div class="wrap-header h3wrap"><h3 id="list-of-extensions"><a aria-hidden="true" tabindex="-1" href="#list-of-extensions"><span class="icon icon-link"></span></a>List of extensions</h3><div class="wrap-body">
<ul>
<li><a href="https://github.com/micromark/micromark-extension-directive"><code>micromark/micromark-extension-directive</code></a>
— support directives (generic extensions)</li>
<li><a href="https://github.com/micromark/micromark-extension-frontmatter"><code>micromark/micromark-extension-frontmatter</code></a>
— support frontmatter (YAML, TOML, etc)</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm"><code>micromark/micromark-extension-gfm</code></a>
— support GFM (GitHub Flavored Markdown)</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-autolink-literal"><code>micromark/micromark-extension-gfm-autolink-literal</code></a>
— support GFM autolink literals</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-footnote"><code>micromark/micromark-extension-gfm-footnote</code></a>
— support GFM footnotes</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-strikethrough"><code>micromark/micromark-extension-gfm-strikethrough</code></a>
— support GFM strikethrough</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-table"><code>micromark/micromark-extension-gfm-table</code></a>
— support GFM tables</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-tagfilter"><code>micromark/micromark-extension-gfm-tagfilter</code></a>
— support GFM tagfilter</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-task-list-item"><code>micromark/micromark-extension-gfm-task-list-item</code></a>
— support GFM tasklists</li>
<li><a href="https://github.com/micromark/micromark-extension-math"><code>micromark/micromark-extension-math</code></a>
— support math</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx"><code>micromark/micromark-extension-mdx</code></a>
— support MDX</li>
<li><a href="https://github.com/micromark/micromark-extension-mdxjs"><code>micromark/micromark-extension-mdxjs</code></a>
— support MDX.js</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx-expression"><code>micromark/micromark-extension-mdx-expression</code></a>
— support MDX (or MDX.js) expressions</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx-jsx"><code>micromark/micromark-extension-mdx-jsx</code></a>
— support MDX (or MDX.js) JSX</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx-md"><code>micromark/micromark-extension-mdx-md</code></a>
— support misc MDX changes</li>
<li><a href="https://github.com/micromark/micromark-extension-mdxjs-esm"><code>micromark/micromark-extension-mdxjs-esm</code></a>
— support MDX.js import/exports</li>
</ul>
<h4 id="community-extensions"><a aria-hidden="true" tabindex="-1" href="#community-extensions"><span class="icon icon-link"></span></a>Community extensions</h4>
<ul>
<li><a href="https://github.com/wataru-chocola/micromark-extension-definition-list"><code>wataru-chocola/micromark-extension-definition-list</code></a>
— support definition lists</li>
</ul>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="syntaxextension"><a aria-hidden="true" tabindex="-1" href="#syntaxextension"><span class="icon icon-link"></span></a><code>SyntaxExtension</code></h3><div class="wrap-body">
<p>A syntax extension is an object whose fields are typically the names of hooks,
referring to where constructs “hook” into.
The fields at such objects are character codes, mapping to constructs as values.</p>
<p>The built in <a href="/packages/micromark/dev/lib/constructs.js">constructs</a> are an example.
See it and <a href="#list-of-extensions">existing extensions</a> for inspiration.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="htmlextension"><a aria-hidden="true" tabindex="-1" href="#htmlextension"><span class="icon icon-link"></span></a><code>HtmlExtension</code></h3><div class="wrap-body">
<p>An HTML extension is an object whose fields are typically <code>enter</code> or <code>exit</code>
(reflecting whether a token is entered or exited).
The values at such objects are names of tokens mapping to handlers.</p>
<p>See <a href="#list-of-extensions">existing extensions</a> for inspiration.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="extending-markdown"><a aria-hidden="true" tabindex="-1" href="#extending-markdown"><span class="icon icon-link"></span></a>Extending markdown</h3><div class="wrap-body">
<p>micromark lets you change markdown syntax, yes, but there are alternatives.
The alternatives are often better.</p>
<p>Over the years, many micromark and remark users have asked about their unique
goals for markdown.
Some exemplary goals are:</p>
<ol>
<li>I want to add <code>rel="nofollow"</code> to external links</li>
<li>I want to add links from headings to themselves</li>
<li>I want line breaks in paragraphs to become hard breaks</li>
<li>I want to support embedded music sheets</li>
<li>I want authors to add arbitrary attributes</li>
<li>I want authors to mark certain blocks with meaning, such as tip, warning,
etc</li>
<li>I want to combine markdown with JS(X)</li>
<li>I want to support our legacy flavor of markdown-like syntax</li>
</ol>
<p>These can be solved in different ways and which solution is best is both
subjective and dependant on unique needs.
Often, there is already a solution in the form of an existing remark or rehype
plugin.
Respectively, their solutions are:</p>
<ol>
<li><a href="https://github.com/remarkjs/remark-external-links"><code>remark-external-links</code></a></li>
<li><a href="https://github.com/rehypejs/rehype-autolink-headings"><code>rehype-autolink-headings</code></a></li>
<li><a href="https://github.com/remarkjs/remark-breaks"><code>remark-breaks</code></a></li>
<li>custom plugin similar to
<a href="https://github.com/remarkjs/remark-math/tree/main/packages/rehype-katex"><code>rehype-katex</code></a>
but integrating <a href="https://www.abcjs.net"><code>abcjs</code></a></li>
<li>either <a href="https://github.com/remarkjs/remark-directive"><code>remark-directive</code></a>
and a custom plugin or with
<a href="https://github.com/jaywcjlove/rehype-attr"><code>rehype-attr</code></a></li>
<li><a href="https://github.com/remarkjs/remark-directive"><code>remark-directive</code></a>
combined with a custom plugin</li>
<li>combining the existing micromark MDX extensions however you please, such as
done by <a href="https://github.com/mdx-js/mdx"><code>mdx-js/mdx</code></a> or
<a href="https://github.com/wooorm/xdm"><code>xdm</code></a></li>
<li>Writing a micromark extension</li>
</ol>
<p>Looking at these from a higher level, they can be categorized:</p>
<ul>
<li>
<p><strong>Changing the output by transforming syntax trees</strong>
(1 and 2)</p>
<p>This category is nice as the format remains plain markdown that authors are
already familiar with and which will work with existing tools and platforms.</p>
<p>Implementations will deal with the syntax tree
(<a href="https://github.com/syntax-tree/mdast"><code>mdast</code></a>) and the ecosystems
<strong><a href="https://github.com/remarkjs/remark">remark</a></strong> and <strong><a href="https://github.com/rehypejs/rehype">rehype</a></strong>.
There are many existing
<a href="https://github.com/syntax-tree/mdast#list-of-utilities">utilities for working with that tree</a>.
Many <a href="https://github.com/remarkjs/remark/blob/main/doc/plugins.md#list-of-plugins">remark plugins</a> and <a href="https://github.com/rehypejs/rehype/blob/main/doc/plugins.md#list-of-plugins">rehype plugins</a> also exist.</p>
</li>
<li>
<p><strong>Using and abusing markdown to add new meaning</strong>
(3, 4, potentially 5)</p>
<p>This category is similar to <em>Changing the output by transforming syntax
trees</em>, but adds a new meaning to certain things which already have
semantics in markdown.</p>
<p>Some examples in pseudo code:</p>
<pre class="language-markdown"><code class="language-markdown code-highlight"><span class="code-line"><span class="token list punctuation">*</span>   <span class="token bold"><span class="token punctuation">**</span><span class="token content">A list item with the first paragraph bold</span><span class="token punctuation">**</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token code keyword">    And then more content, is turned into `&#x3C;dl>` / `&#x3C;dt>` / `&#x3C;dd>` elements</span>
</span><span class="code-line">
</span><span class="code-line">Or, the title attributes on links or images is [overloaded](/url 'rel:nofollow')
</span><span class="code-line">with a new meaning.
</span><span class="code-line">
</span><span class="code-line"><span class="token code"><span class="token punctuation">```</span><span class="token code-language">csv</span>
</span></span><span class="code-line"><span class="token code"><span class="token code-block language-csv"><span class="token value">fenced</span><span class="token punctuation">,</span><span class="token value">code</span><span class="token punctuation">,</span><span class="token value">can</span><span class="token punctuation">,</span><span class="token value">include</span><span class="token punctuation">,</span><span class="token value">data</span>
</span></span></span><span class="code-line"><span class="token code"><span class="token code-block language-csv"><span class="token value">which</span><span class="token punctuation">,</span><span class="token value">is</span><span class="token punctuation">,</span><span class="token value">turned</span><span class="token punctuation">,</span><span class="token value">into</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">graph</span></span>
</span></span><span class="code-line"><span class="token code"><span class="token punctuation">```</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token code"><span class="token punctuation">```</span><span class="token code-language">js data can="be" passed=true</span>
</span></span><span class="code-line"><span class="token code"><span class="token code-block language-js"><span class="token comment">// after the code language name</span></span>
</span></span><span class="code-line"><span class="token code"><span class="token punctuation">```</span></span>
</span><span class="code-line">
</span><span class="code-line">HTML, especially comments, could be used as <span class="token bold"><span class="token punctuation">**</span><span class="token content">markers</span><span class="token punctuation">**</span></span><span class="token comment">&#x3C;!--id="markers"--></span>
</span></code></pre>
</li>
<li>
<p><strong>Arbitrary extension mechanism</strong>
(potentially 5; 6)</p>
<p>This category is nice when content should contain embedded “components”.
Often this means it’s required for authors to have some programming
experience.
There are three good ways to solve arbitrary extensions.</p>
<p><strong>HTML</strong>: Markdown already has an arbitrary extension syntax.
It works in most places and authors are already familiar with the syntax,
but it’s reasonably hard to implement securely.
Certain platforms will remove HTML completely, others sanitize it to varying
degrees.
HTML also supports custom elements.
These could be used and enhanced by client side JavaScript or enhanced when
transforming the syntax tree.</p>
<p><strong>Generic directives</strong>: although
<a href="https://talk.commonmark.org/t/generic-directives-plugins-syntax/444">a proposal</a>
and not supported on most platforms, directives do work with many tools
already.
They’re not the easiest to author compared to, say, a heading, but sometimes
that’s okay.
They do have potential: they nicely solve the need for an infinite number of
potential extensions to markdown in a single markdown-esque way.</p>
<p><strong>MDX</strong> also adds support for components by swapping HTML out for JS(X).
JSX is an extension to JavaScript, so MDX is something along the lines of
literate programming.
This does require knowledge of React (or Vue) and JavaScript, excluding some
authors.</p>
</li>
<li>
<p><strong>Extending markdown syntax</strong>
(7 and 8)</p>
<p>Extend the syntax of markdown means:</p>
<ul>
<li>Authors won’t be familiar with the syntax</li>
<li>Content won’t work in other places (such as on GitHub)</li>
<li>Defeating the purpose of markdown: being simple to author and looking
like what it means</li>
</ul>
<p>…and it’s hard to do as it requires some in-depth knowledge of JavaScript
and parsing.
But it’s possible and in certain cases very powerful.</p>
</li>
</ul>
</div></div></div><div class="wrap h3body-exist"><div class="wrap-header h3wrap"><h3 id="creating-a-micromark-extension"><a aria-hidden="true" tabindex="-1" href="#creating-a-micromark-extension"><span class="icon icon-link"></span></a>Creating a micromark extension</h3><div class="wrap-body">
<p>This section shows how to create an extension for micromark that parses
“variables” (a way to render some data) and one to turn a default construct off.</p>
<blockquote>
<p>Stuck?
See <a href="https://github.com/micromark/.github/blob/HEAD/support.md"><code>support.md</code></a>.</p>
</blockquote>
<h4 id="prerequisites"><a aria-hidden="true" tabindex="-1" href="#prerequisites"><span class="icon icon-link"></span></a>Prerequisites</h4>
<ul>
<li>You should possess an intermediate to high understanding of JavaScript:
it’s going to get a bit complex</li>
<li>Read the readme of <a href="https://github.com/unifiedjs/unified">unified</a> (until you hit the API section) to better
understand where micromark fits</li>
<li>Read the <a href="#architecture">§ Architecture</a> section to understand how micromark
works</li>
<li>Read the <a href="#extending-markdown">§ Extending markdown</a> section to understand
whether it’s a good idea to extend the syntax of markdown</li>
</ul>
<h4 id="extension-basics"><a aria-hidden="true" tabindex="-1" href="#extension-basics"><span class="icon icon-link"></span></a>Extension basics</h4>
<p>micromark supports two types of extensions.
Syntax extensions change how markdown is parsed.
HTML extensions change how it compiles.</p>
<p>HTML extensions are not always needed, as micromark is often used through
<a href="https://github.com/syntax-tree/mdast-util-from-markdown"><code>mdast-util-from-markdown</code></a> to parse to a markdown syntax tree
So instead of an HTML extension a <code>from-markdown</code> utility is needed.
Then, a <a href="https://github.com/syntax-tree/mdast-util-to-markdown"><code>mdast-util-to-markdown</code></a> utility, which is responsible
for serializing syntax trees to markdown, is also needed.</p>
<p>When developing something for internal use only, you can pick and choose which
parts you need.
When open sourcing your extensions, it should probably contain four parts:
syntax extension, HTML extension, <code>from-markdown</code> utility, and a <code>to-markdown</code>
utility.</p>
<p>On to our first case!</p>
<h4 id="case-variables"><a aria-hidden="true" tabindex="-1" href="#case-variables"><span class="icon icon-link"></span></a>Case: variables</h4>
<p>Let’s first outline what we want to make: render some data, similar to how
<a href="https://github.com/Shopify/liquid/wiki/Liquid-for-Designers">Liquid</a> and the
like work, in our markdown.
It could look like this:</p>
<pre class="language-markdown"><code class="language-markdown code-highlight"><span class="code-line">Hello, {planet}!
</span></code></pre>
<p>Turned into:</p>
<pre class="language-html"><code class="language-html code-highlight"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>Hello, Venus!<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
</span></code></pre>
<p>An opening curly brace, followed by one or more characters, and then a closing
brace.
We’ll then look up <code>planet</code> in some object and replace the variable with its
corresponding value, to get something like <code>Venus</code> out.</p>
<p>It looks simple enough, but with markdown there are often a couple more things
to think about.
For this case, I can see the following:</p>
<ul>
<li>Is there a “block” version too?</li>
<li>Are spaces allowed?
Line endings?
Should initial and final white space be ignored?</li>
<li>Balanced nested braces?
Superfluous ones such as <code>{{planet}}</code> or meaningful ones such as
<code>{a {pla} net}</code>?</li>
<li>Character escapes (<code>{pla\}net}</code>) and character references
(<code>{pla&#x26;#x7d;net}</code>)?</li>
</ul>
<p>To keep things as simple as possible, let’s not support a block syntax, see
spaces as special, support line endings, or support nested braces.
But to learn interesting things, we <em>will</em> support character escapes and
-references.</p>
<p>Note that this particular case is already solved quite nicely by
<a href="https://github.com/micromark/micromark-extension-mdx-expression"><code>micromark-extension-mdx-expression</code></a>.
It’s a bit more powerful and does more things, but it can be used to solve this
case and otherwise serve as inspiration.</p>
<h5 id="setup"><a aria-hidden="true" tabindex="-1" href="#setup"><span class="icon icon-link"></span></a>Setup</h5>
<p>Create a new folder, enter it, and set up a new package:</p>
<pre class="language-sh"><code class="language-sh code-highlight"><span class="code-line"><span class="token function">mkdir</span> example
</span><span class="code-line"><span class="token builtin class-name">cd</span> example
</span><span class="code-line"><span class="token function">npm</span> init <span class="token parameter variable">-y</span>
</span></code></pre>
<p>In this example we’ll use ESM, so add <code>type: 'module'</code> to <code>package.json</code>:</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line"><span class="token coord">@@ -2,6 +2,7 @@</span>
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  "name": "example",
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  "type": "module",
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  "main": "index.js",
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1"
</span></span></span></code></pre>
<p>Add a markdown file, <code>example.md</code>, with the following text:</p>
<pre class="language-markdown"><code class="language-markdown code-highlight"><span class="code-line">Hello, {planet}!
</span><span class="code-line">
</span><span class="code-line">{pla\}net} and {pla<span class="token entity" title="}">&#x26;#x7d;</span>net}.
</span></code></pre>
<p>To check if our extension works, add an <code>example.js</code> module, with the following
code:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>promises <span class="token keyword module">as</span> fs<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'node:fs'</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>micromark<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark'</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>variables<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./index.js'</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> buf <span class="token operator">=</span> <span class="token keyword control-flow">await</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readFile</span><span class="token punctuation">(</span><span class="token string">'example.md'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">const</span> out <span class="token operator">=</span> <span class="token function">micromark</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span>variables<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<p>While working on the extension, run <code>node example</code> to see whether things work.
Feel free to add more examples of the variables syntax in <code>example.md</code> if
needed.</p>
<p>Our extension doesn’t work yet, for one because <code>micromark</code> is not installed:</p>
<pre class="language-sh"><code class="language-sh code-highlight"><span class="code-line"><span class="token function">npm</span> <span class="token function">install</span> micromark --save-dev
</span></code></pre>
<p>…and we need to write our extension.
Let’s do that in <code>index.js</code>:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> variables <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span></code></pre>
<p>Although our extension doesn’t do anything, running <code>node example</code> now somewhat
works!</p>
<h5 id="syntax-extension"><a aria-hidden="true" tabindex="-1" href="#syntax-extension"><span class="icon icon-link"></span></a>Syntax extension</h5>
<p>Much in micromark is based on character codes (see <a href="#preprocess">§ Preprocess</a>).
For this extension, the relevant codes are:</p>
<ul>
<li><code>-5</code>
— M-0005 CARRIAGE RETURN (CR)</li>
<li><code>-4</code>
— M-0004 LINE FEED (LF)</li>
<li><code>-3</code>
— M-0003 CARRIAGE RETURN LINE FEED (CRLF)</li>
<li><code>null</code>
— EOF (end of the stream)</li>
<li><code>92</code>
— U+005C BACKSLASH (<code>\</code>)</li>
<li><code>123</code>
— U+007B LEFT CURLY BRACE (<code>{</code>)</li>
<li><code>125</code>
— U+007D RIGHT CURLY BRACE (<code>}</code>)</li>
</ul>
<p>Also relevant are the content types (see <a href="https://github.com/micromark/micromark#content-types">§ Content types</a>).
This extension is a <em>text</em> construct, as it’s parsed alongsides links and such.
The content inside it (between the braces) is <em>string</em>, to support character
escapes and -references.</p>
<p>Let’s write our extension.
Add the following code to <code>index.js</code>:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword">const</span> variableConstruct <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'variable'</span><span class="token punctuation">,</span> <span class="token literal-property property">tokenize</span><span class="token operator">:</span> variableTokenize<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> variables <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token number">123</span><span class="token operator">:</span> variableConstruct<span class="token punctuation">}</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">variableTokenize</span><span class="token punctuation">(</span><span class="token parameter">effects<span class="token punctuation">,</span> ok<span class="token punctuation">,</span> nok</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> start
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'start:'</span><span class="token punctuation">,</span> effects<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> <span class="token function">nok</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<p>The above code exports an extension with the identifier <code>variables</code>.
The extension defines a <em>text</em> construct for the character code <code>123</code>.
The construct has a <code>name</code>, so that it can be turned off (optional, see next
case), and it has a <code>tokenize</code> function that sets up a state machine, which
receives <code>effects</code> and the <code>ok</code> and <code>nok</code> states.
<code>ok</code> can be used when successful, <code>nok</code> when not, and so constructs are a bit
similar to how promises can <em>resolve</em> or <em>reject</em>.
<code>tokenize</code> returns the initial state, <code>start</code>, which itself receives the current
character code, prints some debugging information, and then returns a call
to <code>nok</code>.</p>
<p>Ensure that things work by running <code>node example</code> and see what it prints.</p>
<p>Now we need to define our states and figure out how variables work.
Some people prefer sketching a diagram of the flow.
I often prefer writing it down in pseudo-code prose.
I’ve also found that test driven development works well, where I write unit
tests for how it should work, then write the state machine, and finally use a
code coverage tool to ensure I’ve thought of everything.</p>
<p>In prose, what we have to code looks like this:</p>
<ul>
<li><strong>start</strong>:
Receive <code>123</code> as <code>code</code>, enter a token for the whole (let’s call it
<code>variable</code>), enter a token for the marker (<code>variableMarker</code>), consume
<code>code</code>, exit the marker token, enter a token for the contents
(<code>variableString</code>), switch to <em>begin</em></li>
<li><strong>begin</strong>:
If <code>code</code> is <code>125</code>, reconsume in <em>nok</em>.
Else, reconsume in <em>inside</em></li>
<li><strong>inside</strong>:
If <code>code</code> is <code>-5</code>, <code>-4</code>, <code>-3</code>, or <code>null</code>, reconsume in <code>nok</code>.
Else, if <code>code</code> is <code>125</code>, exit the string token, enter a <code>variableMarker</code>,
consume <code>code</code>, exit the marker token, exit the variable token, and switch
to <em>ok</em>.
Else, consume, and remain in <em>inside</em>.</li>
</ul>
<p>That should be it!
Replace <code>variableTokenize</code> with the following to include the needed states:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword">function</span> <span class="token function">variableTokenize</span><span class="token punctuation">(</span><span class="token parameter">effects<span class="token punctuation">,</span> ok<span class="token punctuation">,</span> nok</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> start
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    effects<span class="token punctuation">.</span><span class="token method function property-access">enter</span><span class="token punctuation">(</span><span class="token string">'variable'</span><span class="token punctuation">)</span>
</span><span class="code-line">    effects<span class="token punctuation">.</span><span class="token method function property-access">enter</span><span class="token punctuation">(</span><span class="token string">'variableMarker'</span><span class="token punctuation">)</span>
</span><span class="code-line">    effects<span class="token punctuation">.</span><span class="token method function property-access">consume</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
</span><span class="code-line">    effects<span class="token punctuation">.</span><span class="token method function property-access">exit</span><span class="token punctuation">(</span><span class="token string">'variableMarker'</span><span class="token punctuation">)</span>
</span><span class="code-line">    effects<span class="token punctuation">.</span><span class="token method function property-access">enter</span><span class="token punctuation">(</span><span class="token string">'variableString'</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> begin
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token function">begin</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> code <span class="token operator">===</span> <span class="token number">125</span> <span class="token operator">?</span> <span class="token function">nok</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">inside</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token function">inside</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>code <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">5</span> <span class="token operator">||</span> code <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">4</span> <span class="token operator">||</span> code <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">3</span> <span class="token operator">||</span> code <span class="token operator">===</span> <span class="token keyword null nil">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span> <span class="token function">nok</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>code <span class="token operator">===</span> <span class="token number">125</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      effects<span class="token punctuation">.</span><span class="token method function property-access">exit</span><span class="token punctuation">(</span><span class="token string">'variableString'</span><span class="token punctuation">)</span>
</span><span class="code-line">      effects<span class="token punctuation">.</span><span class="token method function property-access">enter</span><span class="token punctuation">(</span><span class="token string">'variableMarker'</span><span class="token punctuation">)</span>
</span><span class="code-line">      effects<span class="token punctuation">.</span><span class="token method function property-access">consume</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
</span><span class="code-line">      effects<span class="token punctuation">.</span><span class="token method function property-access">exit</span><span class="token punctuation">(</span><span class="token string">'variableMarker'</span><span class="token punctuation">)</span>
</span><span class="code-line">      effects<span class="token punctuation">.</span><span class="token method function property-access">exit</span><span class="token punctuation">(</span><span class="token string">'variable'</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span> ok
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    effects<span class="token punctuation">.</span><span class="token method function property-access">consume</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> inside
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<p>Run <code>node example</code> again and see what it prints!
The HTML compiler ignores things it doesn’t know, so variables are now removed.</p>
<p>We have our first syntax extension, and it sort of works, but we don’t handle
character escapes and -references yet.
We need to do two things to make that work:
a) skip over <code>\\</code> and <code>\}</code> in our algorithm,
b) tell micromark to parse them.</p>
<p>Change the code in <code>index.js</code> to support escapes like so:</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line">@@ -23,6 +23,11 @@ function variableTokenize(effects, ok, nok) {
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      return nok(code)
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">    }
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span></span>
</span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    if (code === 92) {
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">      effects.consume(code)
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">      return insideEscape
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    }
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    if (code === 125) {
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">      effects.exit('variableString')
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">      effects.enter('variableMarker')
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span></span>@@ -35,4 +40,13 @@ function variableTokenize(effects, ok, nok) {
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    effects.consume(code)
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">    return inside
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">  }
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  function insideEscape(code) {
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    if (code === 92 || code === 125) {
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">      effects.consume(code)
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">      return inside
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    }
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    return inside(code)
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  }
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}
</span></span></span></code></pre>
<p>Finally add support for character references and character escapes between
braces by adding a special token that defines a content type:</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line">@@ -11,6 +11,7 @@ function variableTokenize(effects, ok, nok) {
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    effects.consume(code)
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">    effects.exit('variableMarker')
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">    effects.enter('variableString')
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    effects.enter('chunkString', {contentType: 'string'})
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    return begin
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">  }
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span></span>
</span><span class="code-line">@@ -29,6 +30,7 @@ function variableTokenize(effects, ok, nok) {
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    }
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span></span>
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    if (code === 125) {
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      effects.exit('chunkString')
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      effects.exit('variableString')
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">      effects.enter('variableMarker')
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">      effects.consume(code)
</span></span></span></code></pre>
<p>Tokens with a <code>contentType</code> will be replaced by <em>postprocess</em> (see
<a href="https://github.com/micromark/micromark#postprocess">§ Postprocess</a>) by the tokens belonging to that content type.</p>
<h5 id="html-extension"><a aria-hidden="true" tabindex="-1" href="#html-extension"><span class="icon icon-link"></span></a>HTML extension</h5>
<p>Up next is an HTML extension to replace variables with data.
Change <code>example.js</code> to use one like so:</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line"><span class="token coord">@@ -1,11 +1,12 @@</span>
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import {promises as fs} from 'node:fs'
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">import {micromark} from 'micromark'
</span></span></span><span class="code-line deleted"><span class="token unchanged"><span class="token line"></span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import {variables} from './index.js'
</span></span></span><span class="code-line inserted"><span class="token deleted-sign deleted"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import {variables, variablesHtml} from './index.js'
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span>
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">main()
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span></span>
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">async function main() {
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">  const buf = await fs.readFile('example.md')
</span></span></span><span class="code-line deleted"><span class="token unchanged"><span class="token line"></span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  const out = micromark(buf, {extensions: [variables]})
</span></span></span><span class="code-line inserted"><span class="token deleted-sign deleted"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const html = variablesHtml({planet: '1', 'pla}net': '2'})
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  const out = micromark(buf, {extensions: [variables], htmlExtensions: [html]})
</span></span></span><span class="code-line"><span class="token inserted-sign inserted"><span class="token line"></span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  console.log(out)
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span></span></code></pre>
<p>And add the HTML extension, <code>variablesHtml</code>, to <code>index.js</code> like so:</p>
<pre class="language-diff"><code class="language-diff code-highlight"><span class="code-line">@@ -52,3 +52,19 @@ function variableTokenize(effects, ok, nok) {
</span><span class="code-line"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    return inside(code)
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">  }
</span></span></span><span class="code-line"><span class="token unchanged"><span class="token line"></span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span></span><span class="code-line inserted"><span class="token unchanged"><span class="token line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">export function variablesHtml(data = {}) {
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  return {
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    enter: {variableString: enterVariableString},
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    exit: {variableString: exitVariableString},
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  }
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  function enterVariableString() {
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    this.buffer()
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  }
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  function exitVariableString() {
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    var id = this.resume()
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    if (id in data) {
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">      this.raw(this.encode(data[id]))
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">    }
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">  }
</span></span></span><span class="code-line inserted"><span class="token inserted-sign inserted"><span class="token line"></span><span class="token prefix inserted">+</span><span class="token line">}
</span></span></span></code></pre>
<p><code>variablesHtml</code> is a function that receives an object mapping “variables” to
strings and returns an HTML extension.
The extension hooks two functions to <code>variableString</code>, one when it starts,
the other when it ends.
We don’t need to do anything to handle the other tokens as they’re already
ignored by default.
<code>enterVariableString</code> calls <code>buffer</code>, which is a function that “stashes” what
would otherwise be emitted.
<code>exitVariableString</code> calls <code>resume</code>, which is the inverse of <code>buffer</code> and
returns the stashed value.
If the variable is defined, we ensure it’s made safe (with <code>this.encode</code>) and
finally output that (with <code>this.raw</code>).</p>
<h5 id="further-exercises"><a aria-hidden="true" tabindex="-1" href="#further-exercises"><span class="icon icon-link"></span></a>Further exercises</h5>
<p>It works!
We’re done!
Of course, it can be better, such as with the following potential features:</p>
<ul>
<li>Add support for empty variables</li>
<li>Add support for spaces between markers and string</li>
<li>Add support for line endings in variables</li>
<li>Add support for nested braces</li>
<li>Add support for blocks</li>
<li>Add warnings on undefined variables</li>
<li>Use <code>micromark-build</code>, and use <code>uvu/assert</code>, <code>debug</code>, and
<code>micromark-util-symbol</code> (see <a href="https://github.com/micromark/micromark#size--debug">§ Size &#x26; debug</a>)</li>
<li>Add <a href="https://github.com/syntax-tree/mdast-util-from-markdown"><code>mdast-util-from-markdown</code></a> and
<a href="https://github.com/syntax-tree/mdast-util-to-markdown"><code>mdast-util-to-markdown</code></a> utilities to parse and serialize the
AST</li>
</ul>
<h4 id="case-turn-off-constructs"><a aria-hidden="true" tabindex="-1" href="#case-turn-off-constructs"><span class="icon icon-link"></span></a>Case: turn off constructs</h4>
<p>Sometimes it’s needed to turn a default construct off.
That’s possible through a syntax extension.
Note that not everything can be turned off (such as paragraphs) and even if it’s
possible to turn something off, it could break micromark (such as character
escapes).</p>
<p>To disable constructs, refer to them by name in an array at the <code>disable.null</code>
field of an extension:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>micromark<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark'</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> extension <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">disable</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword null nil">null</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'codeIndented'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">micromark</span><span class="token punctuation">(</span><span class="token string">'\ta'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span>extension<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre>
<p>Yields:</p>
<pre class="language-html"><code class="language-html code-highlight"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>a<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
</span></code></pre>
</div></div></div></div></div><div class="wrap h2body-exist"><div class="wrap-header h2wrap"><h2 id="architecture"><a aria-hidden="true" tabindex="-1" href="#architecture"><span class="icon icon-link"></span></a>Architecture</h2><div class="wrap-body">
<p>micromark is maintained as a monorepo.
Many of its internals, which are used in <code>micromark</code> (core) but also useful for
developers of extensions or integrations, are available as separate modules.
Each module maintained here is available in <a href="https://github.com/micromark/micromark/tree/main/packages"><code>packages/</code></a>.</p>
</div></div><div class="h2wrap-body"><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="overview"><a aria-hidden="true" tabindex="-1" href="#overview"><span class="icon icon-link"></span></a>Overview</h3><div class="wrap-body">
<p>The naming scheme in <a href="https://github.com/micromark/micromark/tree/main/packages"><code>packages/</code></a> is as follows:</p>
<ul>
<li><code>micromark-build</code>
— Small CLI to build dev code into production code</li>
<li><code>micromark-core-commonmark</code>
— CommonMark constructs used in micromark</li>
<li><code>micromark-factory-*</code>
— Reusable subroutines used to parse parts of constructs</li>
<li><code>micromark-util-*</code>
— Reusable helpers often needed when parsing markdown</li>
<li><code>micromark</code>
— Core module</li>
</ul>
<p>micromark has two interfaces: buffering (maintained in
<a href="https://github.com/micromark/micromark/blob/main/packages/micromark/dev/index.js"><code>micromark/dev/index.js</code></a>)
and streaming (maintained in
<a href="https://github.com/micromark/micromark/blob/main/packages/micromark/dev/stream.js"><code>micromark/dev/stream.js</code></a>).
The first takes all input at once whereas the last uses a Node.js stream to take
input separately.
They thinly wrap how data flows through micromark:</p>
<pre class="language-txt"><code class="language-txt code-highlight"><span class="code-line">                                            micromark
</span><span class="code-line">+-----------------------------------------------------------------------------------------------+
</span><span class="code-line">|            +------------+         +-------+         +-------------+         +---------+       |
</span><span class="code-line">| -markdown->+ preprocess +-chunks->+ parse +-events->+ postprocess +-events->+ compile +-html- |
</span><span class="code-line">|            +------------+         +-------+         +-------------+         +---------+       |
</span><span class="code-line">+-----------------------------------------------------------------------------------------------+
</span></code></pre>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="preprocess"><a aria-hidden="true" tabindex="-1" href="#preprocess"><span class="icon icon-link"></span></a>Preprocess</h3><div class="wrap-body">
<p>The <strong>preprocessor</strong>
(<a href="https://github.com/micromark/micromark/blob/main/packages/micromark/dev/lib/preprocess.js"><code>micromark/dev/lib/preprocess.js</code></a>)
takes markdown and turns it into chunks.</p>
<p>A <strong>chunk</strong> is either a character code or a slice of a buffer in the form of a
string.
Chunks are used because strings are more efficient storage than character codes,
but limited in what they can represent.
For example, the input <code>ab\ncd</code> is represented as <code>['ab', -4, 'cd']</code> in chunks.</p>
<p>A character <strong>code</strong> is often the same as what <code>String#charCodeAt()</code> yields but
micromark adds meaning to certain other values.</p>
<p>In micromark, the actual character U+0009 CHARACTER TABULATION (HT) is replaced
by one M-0002 HORIZONTAL TAB (HT) and between 0 and 3 M-0001 VIRTUAL SPACE (VS)
characters, depending on the column at which the tab occurred.
For example, the input <code>\ta</code> is represented as <code>[-2, -1, -1, -1, 97]</code> and <code>a\tb</code>
as <code>[97, -2, -1, -1, 98]</code> in character codes.</p>
<p>The characters U+000A LINE FEED (LF) and U+000D CARRIAGE RETURN (CR) are
replaced by virtual characters depending on whether they occur together: M-0003
CARRIAGE RETURN LINE FEED (CRLF), M-0004 LINE FEED (LF), and M-0005 CARRIAGE
RETURN (CR).
For example, the input <code>a\r\nb\nc\rd</code> is represented as
<code>[97, -5, 98, -4, 99, -3, 100]</code> in character codes.</p>
<p>The <code>0</code> (U+0000 NUL) character code is replaced by U+FFFD REPLACEMENT CHARACTER
(<code>�</code>).</p>
<p>The <code>null</code> code represents the end of the input stream (called <em>eof</em> for end of
file).</p>
</div></div></div><div class="wrap h3body-exist"><div class="wrap-header h3wrap"><h3 id="parse"><a aria-hidden="true" tabindex="-1" href="#parse"><span class="icon icon-link"></span></a>Parse</h3><div class="wrap-body">
<p>The <strong>parser</strong>
(<a href="https://github.com/micromark/micromark/blob/main/packages/micromark/dev/lib/parse.js"><code>micromark/dev/lib/parse.js</code></a>)
takes chunks and turns them into events.</p>
<p>An <strong>event</strong> is the start or end of a token amongst other events.
Tokens can “contain” other tokens, even though they are stored in a flat list,
by entering before and exiting after them.</p>
<p>A <strong>token</strong> is a span of one or more codes.
Tokens are most of what micromark produces: the built in HTML compiler or other
tools can turn them into different things.
Tokens are essentially names attached to a slice, such as <code>lineEndingBlank</code> for
certain line endings, or <code>codeFenced</code> for a whole fenced code.</p>
<p>Sometimes, more info is attached to tokens, such as <code>_open</code> and <code>_close</code> by
<code>attention</code> (strong, emphasis) to signal whether the sequence can open or close
an attention run.
These fields have to do with how the parser works, which is complex and not
always pretty.</p>
<p>Certain fields (<code>previous</code>, <code>next</code>, and <code>contentType</code>) are used in many cases:
linked tokens for subcontent.
Linked tokens are used because outer constructs are parsed first.
Take for example:</p>
<pre class="language-markdown"><code class="language-markdown code-highlight"><span class="code-line"><span class="token list punctuation">-</span> <span class="token italic"><span class="token punctuation">*</span><span class="token content">a
</span></span></span><span class="code-line"><span class="token italic"><span class="token content">  b</span><span class="token punctuation">*</span></span>.
</span></code></pre>
<ol>
<li>The list marker and the space after it is parsed first</li>
<li>The rest of the line is a <code>chunkFlow</code> token</li>
<li>The two spaces on the second line are a <code>linePrefix</code> of the list</li>
<li>The rest of the line is another <code>chunkFlow</code> token</li>
</ol>
<p>The two <code>chunkFlow</code> tokens are linked together and the chunks they span are
passed through the flow tokenizer.
There the chunks are seen as <code>chunkContent</code> and passed through the content
tokenizer.
There the chunks are seen as a paragraph and seen as <code>chunkText</code> and passed
through the text tokenizer.
Finally, the attention (emphasis) and data (“raw” characters) is parsed there,
and we’re done!</p>
<h4 id="content-types"><a aria-hidden="true" tabindex="-1" href="#content-types"><span class="icon icon-link"></span></a>Content types</h4>
<p>The parser starts out with a document tokenizer.
<em>Document</em> is the top-most content type, which includes containers such as block
quotes and lists.
Containers in markdown come from the margin and include more constructs
on the lines that define them.</p>
<p><em>Flow</em> represents the sections (block constructs such as ATX and setext
headings, HTML, indented and fenced code, thematic breaks), which like
<em>document</em> are also parsed per line.
An example is HTML, which has a certain starting condition (such as <code>&#x3C;script></code>
on its own line), then continues for a while, until an end condition is found
(such as <code>&#x3C;/style></code>).
If that line with an end condition is never found, that flow goes until the end.</p>
<p><em>Content</em> is zero or more definitions, and then zero or one paragraph.
It’s a weird one, and needed to make certain edge cases around definitions spec
compliant.
Definitions are unlike other things in markdown, in that they behave like <em>text</em>
in that they can contain arbitrary line endings, but <em>have</em> to end at a line
ending.
If they end in something else, the whole definition instead is seen as a
paragraph.</p>
<p>The content in markdown first needs to be parsed up to this level to figure out
which things are defined, for the whole document, before continuing on with
<em>text</em>, as whether a link or image reference forms or not depends on whether
it’s defined.
This unfortunately prevents a true streaming markdown parser.</p>
<p><em>Text</em> contains phrasing content (rich inline text: autolinks, character escapes
and -references, code, hard breaks, HTML, images, links, emphasis, strong).</p>
<p><em>String</em> is a limited <em>text</em>-like content type which only allows character
references and character escapes.
It exists in things such as identifiers (media references, definitions),
titles, or URLs and such.</p>
<h4 id="constructs"><a aria-hidden="true" tabindex="-1" href="#constructs"><span class="icon icon-link"></span></a>Constructs</h4>
<p>Constructs are the things that make up markdown.
Some examples are lists, thematic breaks, or character references.</p>
<p>Note that, as a general rule of thumb, markdown is <em>really weird</em>.
It’s essentially made up of edge cases rather than logical rules.
When browsing the built in constructs, or venturing to build your own, you’ll
find confusing new things and run into complex custom hooks.</p>
<p>One more reasonable construct is the thematic break
(<a href="https://github.com/micromark/micromark/blob/main/packages/micromark-core-commonmark/dev/lib/thematic-break.js">see code</a>).
It’s an object that defines a <code>name</code> and a <code>tokenize</code> function.
Most of what constructs do is defined in their required <code>tokenize</code> function,
which sets up a state machine to handle character codes streaming in.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="postprocess"><a aria-hidden="true" tabindex="-1" href="#postprocess"><span class="icon icon-link"></span></a>Postprocess</h3><div class="wrap-body">
<p>The <strong>postprocessor</strong>
(<a href="https://github.com/micromark/micromark/blob/main/packages/micromark/dev/lib/postprocess.js"><code>micromark/dev/lib/postprocess.js</code></a>)
is a small step that takes events, ensures all their
nested content is parsed, and returns the modified events.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="compile"><a aria-hidden="true" tabindex="-1" href="#compile"><span class="icon icon-link"></span></a>Compile</h3><div class="wrap-body">
<p>The <strong>compiler</strong>
(<a href="https://github.com/micromark/micromark/blob/main/packages/micromark/dev/lib/compile.js"><code>micromark/dev/lib/compile.js</code></a>)
takes events and turns them into HTML.
While micromark was created mostly to advance markdown parsing irrespective of
compiling to HTML, the common case of doing so is built in.
A built in HTML compiler is useful because it allows us to check for compliancy
to CommonMark, the de facto norm of markdown, specified in roughly 650
input/output cases.
The parsing parts can still be used separately to build ASTs, CSTs, or many
other output formats.</p>
<p>The compiler has an interface that accepts lists of events instead of the whole
at once, but because markdown can’t truly stream, events are buffered before
compiling and outputting the final result.</p>
</div></div></div></div></div><div class="wrap h2body-exist"><div class="wrap-header h2wrap"><h2 id="examples"><a aria-hidden="true" tabindex="-1" href="#examples"><span class="icon icon-link"></span></a>Examples</h2><div class="wrap-body">
</div></div><div class="h2wrap-body"><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="github-flavored-markdown-gfm"><a aria-hidden="true" tabindex="-1" href="#github-flavored-markdown-gfm"><span class="icon icon-link"></span></a>GitHub flavored markdown (GFM)</h3><div class="wrap-body">
<p>To support GFM (autolink literals, strikethrough, tables, and tasklists) use
<a href="https://github.com/micromark/micromark-extension-gfm"><code>micromark-extension-gfm</code></a>.
Say we have a file like this:</p>
<pre class="language-markdown"><code class="language-markdown code-highlight"><span class="code-line"><span class="token title important"><span class="token punctuation">#</span> GFM</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token title important"><span class="token punctuation">##</span> Autolink literals</span>
</span><span class="code-line">
</span><span class="code-line">www.example.com, https://example.com, and contact@example.com.
</span><span class="code-line">
</span><span class="code-line"><span class="token title important"><span class="token punctuation">##</span> Footnote</span>
</span><span class="code-line">
</span><span class="code-line">A note[^1]
</span><span class="code-line">
</span><span class="code-line"><span class="token url-reference url"><span class="token punctuation">[</span><span class="token variable">^1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> Big</span> note.
</span><span class="code-line">
</span><span class="code-line"><span class="token title important"><span class="token punctuation">##</span> Strikethrough</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token strike"><span class="token punctuation">~</span><span class="token content">one</span><span class="token punctuation">~</span></span> or <span class="token strike"><span class="token punctuation">~~</span><span class="token content">two</span><span class="token punctuation">~~</span></span> tildes.
</span><span class="code-line">
</span><span class="code-line"><span class="token title important"><span class="token punctuation">##</span> Table</span>
</span><span class="code-line">
</span><span class="code-line">| a | b  |  c |  d  |
</span><span class="code-line">| - | :- | -: | :-: |
</span><span class="code-line">
</span><span class="code-line"><span class="token title important"><span class="token punctuation">##</span> Tag filter</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>plaintext</span><span class="token punctuation">></span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token title important"><span class="token punctuation">##</span> Tasklist</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token list punctuation">*</span> [ ] to do
</span><span class="code-line"><span class="token list punctuation">*</span> [x] done
</span></code></pre>
<p>Then do something like this:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">fs</span> <span class="token keyword module">from</span> <span class="token string">'node:fs'</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>micromark<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark'</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>gfm<span class="token punctuation">,</span> gfmHtml<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark-extension-gfm'</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> doc <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readFileSync</span><span class="token punctuation">(</span><span class="token string">'example.md'</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">micromark</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">gfm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">htmlExtensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">gfmHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre>
<details>
<summary>Show equivalent HTML</summary>
<pre class="language-html"><code class="language-html code-highlight"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span>GFM<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Autolink literals<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.example.com<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>www.example.com<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>, <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://example.com<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>https://example.com<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>, and <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mailto:contact@example.com<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>contact@example.com<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Footnote<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>A note<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>sup</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#user-content-fn-1<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user-content-fnref-1<span class="token punctuation">"</span></span> <span class="token attr-name">data-footnote-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">aria-describedby</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>footnote-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>sup</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Strikethrough<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>del</span><span class="token punctuation">></span></span>one<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>del</span><span class="token punctuation">></span></span> or <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>del</span><span class="token punctuation">></span></span>two<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>del</span><span class="token punctuation">></span></span> tildes.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Table<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>table</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>thead</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>tr</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>th</span><span class="token punctuation">></span></span>a<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>th</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>th</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>b<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>th</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>th</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>c<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>th</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>th</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>d<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>th</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>tr</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>thead</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>table</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Tag filter<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token entity named-entity" title="<">&#x26;lt;</span>plaintext<span class="token entity named-entity" title=">">&#x26;gt;</span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Tasklist<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ul</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> to do<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>input</span> <span class="token attr-name">checked</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> done<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ul</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>section</span> <span class="token attr-name">data-footnotes</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>footnotes<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>footnote-label<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sr-only<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Footnotes<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ol</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>li</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user-content-fn-1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>Big note. <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#user-content-fnref-1<span class="token punctuation">"</span></span> <span class="token attr-name">data-footnote-backref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>data-footnote-backref<span class="token punctuation">"</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Back to content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>↩<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>li</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ol</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>section</span><span class="token punctuation">></span></span>
</span></code></pre>
</details>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="math"><a aria-hidden="true" tabindex="-1" href="#math"><span class="icon icon-link"></span></a>Math</h3><div class="wrap-body">
<p>To support math use <a href="https://github.com/micromark/micromark-extension-math"><code>micromark-extension-math</code></a>.
Say we have a file like this:</p>
<pre class="language-markdown"><code class="language-markdown code-highlight"><span class="code-line">Lift($L$) can be determined by Lift Coefficient ($C_L$) like the following equation.
</span><span class="code-line">
</span><span class="code-line">$$
</span><span class="code-line">L = \frac{1}{2} \rho v^2 S C_L
</span><span class="code-line">$$
</span></code></pre>
<p>Then do something like this:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">fs</span> <span class="token keyword module">from</span> <span class="token string">'node:fs'</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>micromark<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark'</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>math<span class="token punctuation">,</span> mathHtml<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'micromark-extension-math'</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> doc <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readFileSync</span><span class="token punctuation">(</span><span class="token string">'example.md'</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token function">micromark</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span>math<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">htmlExtensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">mathHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre>
<details>
<summary>Show equivalent HTML</summary>
<pre class="language-html"><code class="language-html code-highlight"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>Lift(<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>math math-inline<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>katex<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>…<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span>) can be determined by Lift Coefficient (<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>math math-inline<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>katex<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>…<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span>) like the following equation.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>math math-display<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>katex-display<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>katex<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>…<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span></code></pre>
</details>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="syntax-tree"><a aria-hidden="true" tabindex="-1" href="#syntax-tree"><span class="icon icon-link"></span></a>Syntax tree</h3><div class="wrap-body">
<p>A higher level project, <a href="https://github.com/syntax-tree/mdast-util-from-markdown"><code>mdast-util-from-markdown</code></a>, can give
you an AST.</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">fromMarkdown</span> <span class="token keyword module">from</span> <span class="token string">'mdast-util-from-markdown'</span> <span class="token comment">// This wraps micromark.</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">fromMarkdown</span><span class="token punctuation">(</span><span class="token string">'## Hello, *world*!'</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span></code></pre>
<p>Yields:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'heading'</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">depth</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line">    <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'Hello, '</span><span class="token punctuation">,</span> <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token known-class-name class-name">Object</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'emphasis'</span><span class="token punctuation">,</span> <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token known-class-name class-name">Array</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token known-class-name class-name">Object</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'!'</span><span class="token punctuation">,</span> <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token known-class-name class-name">Object</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token literal-property property">start</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">line</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">column</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token literal-property property">end</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">line</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">column</span><span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<p>Another level up is <a href="https://github.com/remarkjs/remark"><strong>remark</strong></a>, which provides a nice interface and
hundreds of plugins.</p>
</div></div></div></div></div><div class="wrap h2body-exist"><div class="wrap-header h2wrap"><h2 id="markdown"><a aria-hidden="true" tabindex="-1" href="#markdown"><span class="icon icon-link"></span></a>Markdown</h2><div class="wrap-body">
</div></div><div class="h2wrap-body"><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="commonmark"><a aria-hidden="true" tabindex="-1" href="#commonmark"><span class="icon icon-link"></span></a>CommonMark</h3><div class="wrap-body">
<p>The first definition of “Markdown” gave several examples of how it worked,
showing input Markdown and output HTML, and came with a reference implementation
(<code>Markdown.pl</code>).
When new implementations followed, they mostly followed the first definition,
but deviated from the first implementation, and added extensions, thus making
the format a family of formats.</p>
<p>Some years later, an attempt was made to standardize the differences between
implementations, by specifying how several edge cases should be handled, through
more input and output examples.
This is known as <a href="https://commonmark.org">CommonMark</a>, and many implementations now
work towards some degree of CommonMark compliancy.
Still, CommonMark describes what the output in HTML should be given some
input, which leaves many edge cases up for debate, and does not answer what
should happen for other output formats.</p>
<p>micromark passes all tests from CommonMark and has many more tests to match the
CommonMark reference parsers.
Finally, it comes with <a href="https://github.com/micromark/common-markup-state-machine">CMSM</a>, which describes how to parse markup, instead
of documenting input and output examples.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="grammar"><a aria-hidden="true" tabindex="-1" href="#grammar"><span class="icon icon-link"></span></a>Grammar</h3><div class="wrap-body">
<p>The syntax of markdown can be described in Backus–Naur form (BNF) as:</p>
<pre class="language-bnf"><code class="language-bnf code-highlight"><span class="code-line">markdown = .<span class="token operator">*</span>
</span></code></pre>
<p>No, that’s <a href="http://trevorjim.com/a-specification-for-markdown/">not a typo</a>:
markdown has no syntax errors; anything thrown at it renders <em>something</em>.</p>
</div></div></div></div></div><div class="wrap h2body-exist"><div class="wrap-header h2wrap"><h2 id="project"><a aria-hidden="true" tabindex="-1" href="#project"><span class="icon icon-link"></span></a>Project</h2><div class="wrap-body">
</div></div><div class="h2wrap-body"><div class="wrap h3body-exist"><div class="wrap-header h3wrap"><h3 id="comparison"><a aria-hidden="true" tabindex="-1" href="#comparison"><span class="icon icon-link"></span></a>Comparison</h3><div class="wrap-body">
<p>There are many other markdown parsers out there and maybe they’re better suited
to your use case!
Here is a short comparison of a couple in JavaScript.
Note that this list is made by the folks who make <code>micromark</code> and <code>remark</code>, so
there is some bias.</p>
<p><strong>Note</strong>: these are, in fact, not really comparable: micromark (and remark)
focus on completely different things than other markdown parsers do.
Sure, you can generate HTML from markdown with them, but micromark (and remark)
are created for (abstract or concrete) syntax trees—to inspect, transform, and
generate content, so that you can make things like <a href="https://github.com/mdx-js/mdx">MDX</a>, <a href="https://github.com/prettier/prettier">Prettier</a>, or
<a href="https://github.com/gatsbyjs/gatsby">Gatsby</a>.</p>
<h6 id="micromark"><a aria-hidden="true" tabindex="-1" href="#micromark"><span class="icon icon-link"></span></a>micromark</h6>
<p>micromark can be used in two different ways.
It can either be used, optionally with existing extensions, to get HTML easily.
Or, it can give tremendous power, such as access to all tokens with positional
info, at the cost of being hard to get into.
It’s super small, pretty fast, and has 100% CommonMark compliance.
It has syntax extensions, such as supporting 100% GFM compliance (with
<code>micromark-extension-gfm</code>), but they’re rather complex to write.
It’s the newest parser on the block, which means it’s fresh and well suited for
contemporary markdown needs, but it’s also battle-tested, and already the 3rd
most popular markdown parser in JavaScript.</p>
<p>If you’re looking for fine grained control, use micromark.
If you just want HTML from markdown, use micromark.</p>
<h6 id="remark"><a aria-hidden="true" tabindex="-1" href="#remark"><span class="icon icon-link"></span></a>remark</h6>
<p><a href="https://github.com/remarkjs/remark">remark</a> is the most popular markdown parser.
It’s built on top of <code>micromark</code> and boasts syntax trees.
For an analogy, it’s like if Babel, ESLint, and more, were one project.
It supports the syntax extensions that micromark has (so it’s 100% CM compliant
and can be 100% GFM compliant), but most of the work is done in plugins that
transform or inspect the tree, and there’s <em>tons</em> of them.
Transforming the tree is relatively easy: it’s a JSON object that can be
manipulated directly.
remark is stable, widely used, and extremely powerful for handling complex data.</p>
<p>You probably should use <a href="https://github.com/remarkjs/remark">remark</a>.</p>
<h6 id="marked"><a aria-hidden="true" tabindex="-1" href="#marked"><span class="icon icon-link"></span></a>marked</h6>
<p><a href="https://github.com/markedjs/marked">marked</a> is the oldest markdown parser on the block.
It’s been around for ages, is battle tested, small, popular, and has a bunch of
extensions, but doesn’t match CommonMark or GFM, and is unsafe by default.</p>
<p>If you have markdown you trust and want to turn it into HTML without a fuss, and
don’t care about perfect compatibility with CommonMark or GFM, but do appreciate
a small bundle size and stability, use <a href="https://github.com/markedjs/marked">marked</a>.</p>
<h6 id="markdown-it"><a aria-hidden="true" tabindex="-1" href="#markdown-it"><span class="icon icon-link"></span></a>markdown-it</h6>
<p><a href="https://github.com/markdown-it/markdown-it">markdown-it</a> is a good, stable, and essentially CommonMark compliant markdown
parser, with (optional) support for some GFM features as well.
It’s used a lot as a direct dependency in packages, but is rather big.
It shines at syntax extensions, where you want to support not just markdown, but
<em>your</em> (company’s) version of markdown.</p>
<p>If you need a couple of custom syntax extensions to your otherwise
CommonMark-compliant markdown, and want to get HTML out, use <a href="https://github.com/markdown-it/markdown-it">markdown-it</a>.</p>
<h6 id="others"><a aria-hidden="true" tabindex="-1" href="#others"><span class="icon icon-link"></span></a>Others</h6>
<p>There are lots of other markdown parsers!
Some say they’re small, or fast, or that they’re CommonMark compliant—but
that’s not always true.
This list is not supposed to be exhaustive (but it’s the most relevant ones).
This list of markdown parsers is a snapshot in time of why (not) to use
(alternatives to) <code>micromark</code>: they’re all good choices, depending on what your
goals are.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="test"><a aria-hidden="true" tabindex="-1" href="#test"><span class="icon icon-link"></span></a>Test</h3><div class="wrap-body">
<p>micromark is tested with the ~650 CommonMark tests and more than 1.2k extra
tests confirmed with CM reference parsers.
These tests reach all branches in the code, which means that this project has
100% code coverage.
Finally, we use fuzz testing to ensure micromark is stable, reliable, and
secure.</p>
<p>To build, format, and test the codebase, use <code>$ npm test</code> after clone and
install.
The <code>$ npm run test-api</code> and <code>$ npm run test-coverage</code> scripts check either the
unit tests, or both them and their coverage, respectively.</p>
<p>The <code>$ npm run test-fuzz</code> script does fuzz testing for 15 minutes.
The timeout is provided by GNU coreutils <strong>timeout(1)</strong>, which might not be
available on your system.
Either install <code>timeout</code> or remove that part temporarily from the script and
manually exit the program after a while.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="size--debug"><a aria-hidden="true" tabindex="-1" href="#size--debug"><span class="icon icon-link"></span></a>Size &#x26; debug</h3><div class="wrap-body">
<p>micromark is really small.
A ton of time went into making sure it minifies well, by the way code is written
but also through custom build scripts to pre-evaluate certain expressions.
Furthermore, care went into making it compress well with gzip and brotli.</p>
<p>Normally, you’ll use the pre-evaluated version of micromark.
While developing, debugging, or testing your code, you <em>should</em> switch to use
code instrumented with assertions and debug messages:</p>
<pre class="language-sh"><code class="language-sh code-highlight"><span class="code-line"><span class="token function">node</span> <span class="token parameter variable">--conditions</span> development module.js
</span></code></pre>
<p>To see debug messages, use a <code>DEBUG</code> env variable set to <code>micromark</code>:</p>
<pre class="language-sh"><code class="language-sh code-highlight"><span class="code-line"><span class="token assign-left variable">DEBUG</span><span class="token operator">=</span><span class="token string">"*"</span> <span class="token function">node</span> <span class="token parameter variable">--conditions</span> development module.js
</span></code></pre>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="version"><a aria-hidden="true" tabindex="-1" href="#version"><span class="icon icon-link"></span></a>Version</h3><div class="wrap-body">
<p>micromark adheres to <a href="https://semver.org">semver</a> since 3.0.0.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="security"><a aria-hidden="true" tabindex="-1" href="#security"><span class="icon icon-link"></span></a>Security</h3><div class="wrap-body">
<p>The typical security aspect discussed for markdown is <a href="https://en.wikipedia.org/wiki/Cross-site_scripting">cross-site scripting
(XSS)</a> attacks.
Markdown itself is safe if it does not include embedded HTML or dangerous
protocols in links/images (such as <code>javascript:</code> or <code>data:</code>).
micromark makes any markdown safe by default, even if HTML is embedded or
dangerous protocols are used, as it encodes or drops them.
Turning on the <code>allowDangerousHtml</code> or <code>allowDangerousProtocol</code> options for
user-provided markdown opens you up to XSS attacks.</p>
<p>Another security aspect is DDoS attacks.
For example, an attacker could throw a 100mb file at micromark, in which case
the JavaScript engine will run out of memory and crash.
It is also possible to crash micromark with smaller payloads, notably when
thousands of links, images, emphasis, or strong are opened but not closed.
It is wise to cap the accepted size of input (500kb can hold a big book) and to
process content in a different thread or worker so that it can be stopped when
needed.</p>
<p>Using extensions might also be unsafe, refer to their documentation for more
information.</p>
<p>For more information on markdown sanitation, see
<a href="https://github.com/ChALkeR/notes/blob/master/Improper-markup-sanitization.md"><code>improper-markup-sanitization.md</code></a> by <a href="https://github.com/ChALkeR"><strong>@chalker</strong></a>.</p>
<p>See <a href="https://github.com/micromark/.github/blob/HEAD/security.md"><code>security.md</code></a> in <a href="https://github.com/micromark/.github"><code>micromark/.github</code></a> for how to
submit a security report.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="contribute"><a aria-hidden="true" tabindex="-1" href="#contribute"><span class="icon icon-link"></span></a>Contribute</h3><div class="wrap-body">
<p>See <a href="https://github.com/micromark/.github/blob/HEAD/contributing.md"><code>contributing.md</code></a> in <a href="https://github.com/micromark/.github"><code>micromark/.github</code></a> for ways
to get started.
See <a href="https://github.com/micromark/.github/blob/HEAD/support.md"><code>support.md</code></a> for ways to get help.</p>
<p>This project has a <a href="https://github.com/micromark/.github/blob/HEAD/code-of-conduct.md">code of conduct</a>.
By interacting with this repository, organisation, or community you agree to
abide by its terms.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="sponsor"><a aria-hidden="true" tabindex="-1" href="#sponsor"><span class="icon icon-link"></span></a>Sponsor</h3><div class="wrap-body">
<p>Support this effort and give back by sponsoring on <a href="https://opencollective.com/unified">OpenCollective</a>!</p>
<table>
<tbody><tr valign="middle">
<td width="100%" align="center" colspan="10">
  <br>
  <a href="https://www.salesforce.com">Salesforce</a> 🏅<br><br>
  <a href="https://www.salesforce.com"><img src="https://images.opencollective.com/salesforce/ca8f997/logo/512.png" width="256"></a>
</td>
</tr>
<tr valign="middle">
<td width="20%" align="center" rowspan="2" colspan="2">
  <a href="https://vercel.com">Vercel</a><br><br>
  <a href="https://vercel.com"><img src="https://avatars1.githubusercontent.com/u/14985020?s=256&#x26;v=4" width="128"></a>
</td>
<td width="20%" align="center" rowspan="2" colspan="2">
  <a href="https://motif.land">Motif</a><br><br>
  <a href="https://motif.land"><img src="https://avatars1.githubusercontent.com/u/74457950?s=256&#x26;v=4" width="128"></a>
</td>
<td width="20%" align="center" rowspan="2" colspan="2">
  <a href="https://www.hashicorp.com">HashiCorp</a><br><br>
  <a href="https://www.hashicorp.com"><img src="https://avatars1.githubusercontent.com/u/761456?s=256&#x26;v=4" width="128"></a>
</td>
<td width="20%" align="center" rowspan="2" colspan="2">
  <a href="https://www.gitbook.com">GitBook</a><br><br>
  <a href="https://www.gitbook.com"><img src="https://avatars1.githubusercontent.com/u/7111340?s=256&#x26;v=4" width="128"></a>
</td>
<td width="20%" align="center" rowspan="2" colspan="2">
  <a href="https://www.gatsbyjs.org">Gatsby</a><br><br>
  <a href="https://www.gatsbyjs.org"><img src="https://avatars1.githubusercontent.com/u/12551863?s=256&#x26;v=4" width="128"></a>
</td>
</tr>
<tr valign="middle">
</tr>
<tr valign="middle">
<td width="20%" align="center" rowspan="2" colspan="2">
  <a href="https://www.netlify.com">Netlify</a><br><br>
  <!--OC has a sharper image-->
  <a href="https://www.netlify.com"><img src="https://images.opencollective.com/netlify/4087de2/logo/256.png" width="128"></a>
</td>
<td width="10%" align="center">
  <a href="https://www.coinbase.com">Coinbase</a><br><br>
  <a href="https://www.coinbase.com"><img src="https://avatars1.githubusercontent.com/u/1885080?s=256&#x26;v=4" width="64"></a>
</td>
<td width="10%" align="center">
  <a href="https://themeisle.com">ThemeIsle</a><br><br>
  <a href="https://themeisle.com"><img src="https://avatars1.githubusercontent.com/u/58979018?s=128&#x26;v=4" width="64"></a>
</td>
<td width="10%" align="center">
  <a href="https://expo.io">Expo</a><br><br>
  <a href="https://expo.io"><img src="https://avatars1.githubusercontent.com/u/12504344?s=128&#x26;v=4" width="64"></a>
</td>
<td width="10%" align="center">
  <a href="https://boostnote.io">Boost Note</a><br><br>
  <a href="https://boostnote.io"><img src="https://images.opencollective.com/boosthub/6318083/logo/128.png" width="64"></a>
</td>
<td width="10%" align="center">
  <a href="https://www.holloway.com">Holloway</a><br><br>
  <a href="https://www.holloway.com"><img src="https://avatars1.githubusercontent.com/u/35904294?s=128&#x26;v=4" width="64"></a>
</td>
<td width="10%"></td>
<td width="10%"></td>
<td width="10%"></td>
</tr>
<tr valign="middle">
<td width="100%" align="center" colspan="8">
  <br>
  <a href="https://opencollective.com/unified"><strong>You?</strong></a>
  <br><br>
</td>
</tr>
</tbody></table>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="origin-story"><a aria-hidden="true" tabindex="-1" href="#origin-story"><span class="icon icon-link"></span></a>Origin story</h3><div class="wrap-body">
<p>Over the summer of 2018, micromark was planned, and the idea shared in August
with a couple of friends and potential sponsors.
The problem I (<strong><a href="https://github.com/wooorm">@wooorm</a></strong>) had was that issues were piling up in remark and
other repos, but my day job (teaching) was fun, fulfilling, and deserved time
too.
It was getting hard to combine the two.
The thought was to feed two birds with one scone: fix the issues in remark with
a new markdown parser (codename marydown) while being financially supported by
sponsors building fancy stuff on top, such as Gatsby, Contentful, and Vercel
(ZEIT at the time).
<strong><a href="https://github.com/johno">@johno</a></strong> was making MDX on top of remark at the time (important historical
note: several other folks were working on JSX + markdown too).
We bundled our strengths: MDX was getting some traction and we thought together
we could perhaps make something sustainable.</p>
<p>In November 2018, we launched with the idea for micromark to solve all existing
bugs, sustaining the existing hundreds of projects, and furthering the exciting
high-level project MDX.
We pushed a single name: unified (which back then was a small but essential
part of the chain).
Gatsby and Vercel were immediate sponsors.
We didn’t know whether it would work, and it worked.
But now you have a new problem: you are getting some financial support (much
more than other open source projects) but it’s not enough money for rent, and
too much money to print stickers with.
You still have your job and issues are still piling up.</p>
<p>At the start of summer 2019, after a couple months of saving up donations, I
quit my job and worked on unified through fall.
That got the number of open issues down significantly and set up a strong
governance and maintenance system for the collective.
But when the time came to work on micromark, the money was gone again, so I
contracted through winter 2019, and in spring 2020 I could do about half open
source, half contracting.
One of the contracting gigs was to write a new MDX parser, for which I also
documented how to do that with a state machine <a href="https://github.com/micromark/mdx-state-machine">in prose</a>.
That gave me the insight into how the same could be done for markdown: I drafted
<a href="https://github.com/micromark/common-markup-state-machine">CMSM</a>, which was some of the core ideas for micromark, but in prose.</p>
<p>In May 2020, Salesforce reached out: they saw the bugs in remark, how micromark
could help, and the initial work on CMSM.
And they had thousands of Markdown files.
In a for open source uncharacteristic move, they decided to fund my work on
micromark.
A large part of what maintaining open source means, is putting out fires,
triaging issues, and making sure users and sponsors are happy, so it was
amazing to get several months to just focus and make something new.
I remember feeling that this project would probably be the hardest thing I’d
work on: yeah, parsers are pretty difficult, but markdown is on another level.
Markdown is such a giant stack of edge cases on edge cases on even more
weirdness, what a mess.
On August 20, 2020, I released <a href="https://github.com/micromark/micromark/releases/tag/2.0.0">2.0.0</a>, the first working version of
micromark.
And it’s hard to describe how that moment felt.
It was great.</p>
</div></div></div><div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="license"><a aria-hidden="true" tabindex="-1" href="#license"><span class="icon icon-link"></span></a>License</h3><div class="wrap-body">
<p><a href="https://github.com/micromark/micromark/blob/main/license">MIT</a> © <a href="https://wooorm.com">Titus Wormer</a></p>
<!-- Definitions -->
</div></div></div></div></div></div></div><footer class="footer-wrap"><footer class="max-container">© 2022 Kenny Wang.</footer></footer><script>
if(('onhashchange' in window) && ((typeof document.documentMode==='undefined') || document.documentMode==8)) {
  window.onhashchange = function () {
    anchorPoint()
    updateAnchor()
  };
}
function anchorPoint() {
  const hash = window.location.hash?.replace(/^#/, '') || '';
  const elm = document.getElementById(decodeURIComponent(hash));
  Array.from(document.querySelectorAll('.h2wrap-body .wrap')).forEach((elm) => elm.classList.remove('active'))
  if (elm?.tagName === 'H3') {
    elm?.parentElement?.parentElement?.classList.add('active');
  }
}
anchorPoint();

function updateAnchor(element) {
  const anchorContainer = document.querySelectorAll('.menu-tocs .menu-modal a.tocs-link');
  anchorContainer.forEach((tocanchor) => {
    tocanchor.classList.remove('is-active-link');
  });
  const anchor = element || document.querySelector(`a.tocs-link[href='${decodeURIComponent(window.location.hash)}']`);
  if (anchor) {
    anchor.classList.add('is-active-link');
  }
}
// toc 定位
updateAnchor()
const anchor = document.querySelectorAll('.menu-tocs .menu-modal a.tocs-link');
anchor.forEach((item) => {
  item.addEventListener('click', (e) => {
    updateAnchor()
  })
})
</script></body>
</html>
