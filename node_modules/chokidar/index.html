<!doctype html>
<html lang="en" data-color-mode="dark">
<head>
<meta charset="utf-8">
<title># Chokidar [![Weekly downloads](https://img.shields.io/npm/dw/chokidar.svg)](https://github.com/paulmillr/chokidar) [![Yearly downloads](https://img.shields.io/npm/dy/chokidar.svg)](https://github.com/paulmillr/chokidar)

> Minimal and efficient cross-platform file watching library

[![NPM](https://nodei.co/npm/chokidar.png)](https://www.npmjs.com/package/chokidar)

## Why?

Node.js `fs.watch`:

* Doesn't report filenames on MacOS.
* Doesn't report events at all when using editors like Sublime on MacOS.
* Often reports events twice.
* Emits most changes as `rename`.
* Does not provide an easy way to recursively watch file trees.
* Does not support recursive watching on Linux.

Node.js `fs.watchFile`:

* Almost as bad at event handling.
* Also does not provide any recursive watching.
* Results in high CPU utilization.

Chokidar resolves these problems.

Initially made for **[Brunch](https://brunch.io/)** (an ultra-swift web app build tool), it is now used in
[Microsoft's Visual Studio Code](https://github.com/microsoft/vscode),
[gulp](https://github.com/gulpjs/gulp/),
[karma](https://karma-runner.github.io/),
[PM2](https://github.com/Unitech/PM2),
[browserify](http://browserify.org/),
[webpack](https://webpack.github.io/),
[BrowserSync](https://www.browsersync.io/),
and [many others](https://www.npmjs.com/browse/depended/chokidar).
It has proven itself in production environments.

Version 3 is out! Check out our blog post about it: [Chokidar 3: How to save 32TB of traffic every week](https://paulmillr.com/posts/chokidar-3-save-32tb-of-traffic/)

## How?

Chokidar does still rely on the Node.js core `fs` module, but when using
`fs.watch` and `fs.watchFile` for watching, it normalizes the events it
receives, often checking for truth by getting file stats and/or dir contents.

On MacOS, chokidar by default uses a native extension exposing the Darwin
`FSEvents` API. This provides very efficient recursive watching compared with
implementations like `kqueue` available on most \*nix platforms. Chokidar still
does have to do some work to normalize the events received that way as well.

On most other platforms, the `fs.watch`-based implementation is the default, which
avoids polling and keeps CPU usage down. Be advised that chokidar will initiate
watchers recursively for everything within scope of the paths that have been
specified, so be judicious about not wasting system resources by watching much
more than needed.

## Getting started

Install with npm:

```sh
npm install chokidar
```

Then `require` and use it in your code:

```javascript
const chokidar  &#x26;   Quick Reference</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta description="为开发人员分享快速参考备忘单。">
<meta keywords="Quick,Reference,cheatsheet,">
<link rel="icon" href="data:image/svg+xml,%3Csvg%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%221em%22%20width%3D%221em%22%3E%20%3Cpath%20d%3D%22m21.66%2010.44-.98%204.18c-.84%203.61-2.5%205.07-5.62%204.77-.5-.04-1.04-.13-1.62-.27l-1.68-.4c-4.17-.99-5.46-3.05-4.48-7.23l.98-4.19c.2-.85.44-1.59.74-2.2%201.17-2.42%203.16-3.07%206.5-2.28l1.67.39c4.19.98%205.47%203.05%204.49%207.23Z%22%20fill%3D%22%23c9d1d9%22%2F%3E%20%3Cpath%20d%3D%22M15.06%2019.39c-.62.42-1.4.77-2.35%201.08l-1.58.52c-3.97%201.28-6.06.21-7.35-3.76L2.5%2013.28c-1.28-3.97-.22-6.07%203.75-7.35l1.58-.52c.41-.13.8-.24%201.17-.31-.3.61-.54%201.35-.74%202.2l-.98%204.19c-.98%204.18.31%206.24%204.48%207.23l1.68.4c.58.14%201.12.23%201.62.27Zm2.43-8.88c-.06%200-.12-.01-.19-.02l-4.85-1.23a.75.75%200%200%201%20.37-1.45l4.85%201.23a.748.748%200%200%201-.18%201.47Z%22%20fill%3D%22%23228e6c%22%20%2F%3E%20%3Cpath%20d%3D%22M14.56%2013.89c-.06%200-.12-.01-.19-.02l-2.91-.74a.75.75%200%200%201%20.37-1.45l2.91.74c.4.1.64.51.54.91-.08.34-.38.56-.72.56Z%22%20fill%3D%22%23228e6c%22%20%2F%3E%20%3C%2Fsvg%3E" type="image/svg+xml">
<link rel="stylesheet" href="..\..\style\style.css">
<link rel="stylesheet" href="..\..\style\katex.css">
</head>
<body class="home"><nav class="header-nav"><div class="max-container"><a href="..\..\index.html" class="logo"><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" height="1em" width="1em">
  <path d="m21.66 10.44-.98 4.18c-.84 3.61-2.5 5.07-5.62 4.77-.5-.04-1.04-.13-1.62-.27l-1.68-.4c-4.17-.99-5.46-3.05-4.48-7.23l.98-4.19c.2-.85.44-1.59.74-2.2 1.17-2.42 3.16-3.07 6.5-2.28l1.67.39c4.19.98 5.47 3.05 4.49 7.23Z" fill="#c9d1d9"></path>
  <path d="M15.06 19.39c-.62.42-1.4.77-2.35 1.08l-1.58.52c-3.97 1.28-6.06.21-7.35-3.76L2.5 13.28c-1.28-3.97-.22-6.07 3.75-7.35l1.58-.52c.41-.13.8-.24 1.17-.31-.3.61-.54 1.35-.74 2.2l-.98 4.19c-.98 4.18.31 6.24 4.48 7.23l1.68.4c.58.14 1.12.23 1.62.27Zm2.43-8.88c-.06 0-.12-.01-.19-.02l-4.85-1.23a.75.75 0 0 1 .37-1.45l4.85 1.23a.748.748 0 0 1-.18 1.47Z" fill="#228e6c"></path>
  <path d="M14.56 13.89c-.06 0-.12-.01-.19-.02l-2.91-.74a.75.75 0 0 1 .37-1.45l2.91.74c.4.1.64.51.54.91-.08.34-.38.56-.72.56Z" fill="#228e6c"></path>
</svg>
<span class="title">Quick Reference</span></a><div class="menu"><a href="https://github.com/jaywcjlove/reference/blob/main/node_modules/chokidar\README.md" class="" target="__blank"><svg viewBox="0 0 36 36" fill="currentColor" height="1em" width="1em"><path d="m33 6.4-3.7-3.7a1.71 1.71 0 0 0-2.36 0L23.65 6H6a2 2 0 0 0-2 2v22a2 2 0 0 0 2 2h22a2 2 0 0 0 2-2V11.76l3-3a1.67 1.67 0 0 0 0-2.36ZM18.83 20.13l-4.19.93 1-4.15 9.55-9.57 3.23 3.23ZM29.5 9.43 26.27 6.2l1.85-1.85 3.23 3.23Z"></path><path fill="none" d="M0 0h36v36H0z"></path></svg><span>编辑</span></a><button id="darkMode" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="light" height="1em" width="1em">
  <path d="M6.995 12c0 2.761 2.246 5.007 5.007 5.007s5.007-2.246 5.007-5.007-2.246-5.007-5.007-5.007S6.995 9.239 6.995 12zM11 19h2v3h-2zm0-17h2v3h-2zm-9 9h3v2H2zm17 0h3v2h-3zM5.637 19.778l-1.414-1.414 2.121-2.121 1.414 1.414zM16.242 6.344l2.122-2.122 1.414 1.414-2.122 2.122zM6.344 7.759 4.223 5.637l1.415-1.414 2.12 2.122zm13.434 10.605-1.414 1.414-2.122-2.122 1.414-1.414z"></path>
</svg>
<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="dark" height="1em" width="1em">
  <path d="M12 11.807A9.002 9.002 0 0 1 10.049 2a9.942 9.942 0 0 0-5.12 2.735c-3.905 3.905-3.905 10.237 0 14.142 3.906 3.906 10.237 3.905 14.143 0a9.946 9.946 0 0 0 2.735-5.119A9.003 9.003 0 0 1 12 11.807z"></path>
</svg>
</button><script>
  const LOCAL_NANE = '_dark_mode_theme_'
  const rememberedValue = localStorage.getItem(LOCAL_NANE);
  if (rememberedValue && ['light', 'dark'].includes(rememberedValue)) {
    document.documentElement.setAttribute('data-color-mode', rememberedValue);
  }
  const button = document.querySelector('#darkMode');
  button.onclick = () => {
    const theme = document.documentElement.dataset.colorMode;
    const mode = theme === 'light' ? 'dark' : 'light';
    document.documentElement.setAttribute('data-color-mode', mode);
    localStorage.setItem(LOCAL_NANE, mode);
  }
</script><a href="https://github.com/jaywcjlove/reference" class="" target="__blank"><svg viewBox="0 0 16 16" fill="currentColor" height="1em" width="1em"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a></div></div></nav><div class="wrap h1body-exist max-container"><header class="wrap-header h1wrap"><h1 id="chokidar--"><a aria-hidden="true" tabindex="-1" href="#chokidar--"><span class="icon icon-link"></span></a>Chokidar <a href="https://github.com/paulmillr/chokidar"><img src="https://img.shields.io/npm/dw/chokidar.svg" alt="Weekly downloads"></a> <a href="https://github.com/paulmillr/chokidar"><img src="https://img.shields.io/npm/dy/chokidar.svg" alt="Yearly downloads"></a></h1><div class="wrap-body">
<blockquote>
<p>Minimal and efficient cross-platform file watching library</p>
</blockquote>
<p><a href="https://www.npmjs.com/package/chokidar"><img src="https://nodei.co/npm/chokidar.png" alt="NPM"></a></p>
</div></header><div class="h1wrap-body"><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="why"><a aria-hidden="true" tabindex="-1" href="#why"><span class="icon icon-link"></span></a>Why?</h2><div class="wrap-body">
<p>Node.js <code>fs.watch</code>:</p>
<ul>
<li>Doesn't report filenames on MacOS.</li>
<li>Doesn't report events at all when using editors like Sublime on MacOS.</li>
<li>Often reports events twice.</li>
<li>Emits most changes as <code>rename</code>.</li>
<li>Does not provide an easy way to recursively watch file trees.</li>
<li>Does not support recursive watching on Linux.</li>
</ul>
<p>Node.js <code>fs.watchFile</code>:</p>
<ul>
<li>Almost as bad at event handling.</li>
<li>Also does not provide any recursive watching.</li>
<li>Results in high CPU utilization.</li>
</ul>
<p>Chokidar resolves these problems.</p>
<p>Initially made for <strong><a href="https://brunch.io/">Brunch</a></strong> (an ultra-swift web app build tool), it is now used in
<a href="https://github.com/microsoft/vscode">Microsoft's Visual Studio Code</a>,
<a href="https://github.com/gulpjs/gulp/">gulp</a>,
<a href="https://karma-runner.github.io/">karma</a>,
<a href="https://github.com/Unitech/PM2">PM2</a>,
<a href="http://browserify.org/">browserify</a>,
<a href="https://webpack.github.io/">webpack</a>,
<a href="https://www.browsersync.io/">BrowserSync</a>,
and <a href="https://www.npmjs.com/browse/depended/chokidar">many others</a>.
It has proven itself in production environments.</p>
<p>Version 3 is out! Check out our blog post about it: <a href="https://paulmillr.com/posts/chokidar-3-save-32tb-of-traffic/">Chokidar 3: How to save 32TB of traffic every week</a></p>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="how"><a aria-hidden="true" tabindex="-1" href="#how"><span class="icon icon-link"></span></a>How?</h2><div class="wrap-body">
<p>Chokidar does still rely on the Node.js core <code>fs</code> module, but when using
<code>fs.watch</code> and <code>fs.watchFile</code> for watching, it normalizes the events it
receives, often checking for truth by getting file stats and/or dir contents.</p>
<p>On MacOS, chokidar by default uses a native extension exposing the Darwin
<code>FSEvents</code> API. This provides very efficient recursive watching compared with
implementations like <code>kqueue</code> available on most *nix platforms. Chokidar still
does have to do some work to normalize the events received that way as well.</p>
<p>On most other platforms, the <code>fs.watch</code>-based implementation is the default, which
avoids polling and keeps CPU usage down. Be advised that chokidar will initiate
watchers recursively for everything within scope of the paths that have been
specified, so be judicious about not wasting system resources by watching much
more than needed.</p>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="getting-started"><a aria-hidden="true" tabindex="-1" href="#getting-started"><span class="icon icon-link"></span></a>Getting started</h2><div class="wrap-body">
<p>Install with npm:</p>
<pre class="language-sh"><code class="language-sh code-highlight"><span class="code-line"><span class="token function">npm</span> <span class="token function">install</span> chokidar
</span></code></pre>
<p>Then <code>require</code> and use it in your code:</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword">const</span> chokidar <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chokidar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// One-liner for current directory</span>
</span><span class="code-line">chokidar<span class="token punctuation">.</span><span class="token method function property-access">watch</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'all'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> path</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-exist"><div class="wrap-header h2wrap"><h2 id="api"><a aria-hidden="true" tabindex="-1" href="#api"><span class="icon icon-link"></span></a>API</h2><div class="wrap-body">
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// Example of a more typical implementation structure</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Initialize watcher.</span>
</span><span class="code-line"><span class="token keyword">const</span> watcher <span class="token operator">=</span> chokidar<span class="token punctuation">.</span><span class="token method function property-access">watch</span><span class="token punctuation">(</span><span class="token string">'file, dir, glob, or array'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token literal-property property">ignored</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"><span class="token group punctuation">(</span><span class="token anchor function">^</span><span class="token alternation keyword">|</span><span class="token char-class"><span class="token char-class-punctuation punctuation">[</span><span class="token escape">\/</span><span class="token special-escape escape">\\</span><span class="token char-class-punctuation punctuation">]</span></span><span class="token group punctuation">)</span><span class="token special-escape escape">\.</span><span class="token char-set class-name">.</span></span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// ignore dotfiles</span>
</span><span class="code-line">  <span class="token literal-property property">persistent</span><span class="token operator">:</span> <span class="token boolean">true</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Something to use when events are received.</span>
</span><span class="code-line"><span class="token keyword">const</span> log <span class="token operator">=</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">.</span><span class="token method function property-access">bind</span><span class="token punctuation">(</span>console<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">// Add event listeners.</span>
</span><span class="code-line">watcher
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token parameter">path</span> <span class="token arrow operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">File </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> has been added</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token parameter">path</span> <span class="token arrow operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">File </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> has been changed</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'unlink'</span><span class="token punctuation">,</span> <span class="token parameter">path</span> <span class="token arrow operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">File </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> has been removed</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// More possible events.</span>
</span><span class="code-line">watcher
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'addDir'</span><span class="token punctuation">,</span> <span class="token parameter">path</span> <span class="token arrow operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Directory </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> has been added</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'unlinkDir'</span><span class="token punctuation">,</span> <span class="token parameter">path</span> <span class="token arrow operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Directory </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> has been removed</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token arrow operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Watcher error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Initial scan complete. Ready for changes'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'raw'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> path<span class="token punctuation">,</span> details</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// internal</span>
</span><span class="code-line">    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Raw event info:'</span><span class="token punctuation">,</span> event<span class="token punctuation">,</span> path<span class="token punctuation">,</span> details<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 'add', 'addDir' and 'change' events also receive stat() results as second</span>
</span><span class="code-line"><span class="token comment">// argument when available: https://nodejs.org/api/fs.html#fs_class_fs_stats</span>
</span><span class="code-line">watcher<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">)</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">File </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> changed size to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stats<span class="token punctuation">.</span><span class="token property-access">size</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Watch new files.</span>
</span><span class="code-line">watcher<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">'new-file'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">watcher<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'new-file-2'</span><span class="token punctuation">,</span> <span class="token string">'new-file-3'</span><span class="token punctuation">,</span> <span class="token string">'**/other-file*'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Get list of actual paths being watched on the filesystem</span>
</span><span class="code-line"><span class="token keyword">var</span> watchedPaths <span class="token operator">=</span> watcher<span class="token punctuation">.</span><span class="token method function property-access">getWatched</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Un-watch some files.</span>
</span><span class="code-line"><span class="token keyword control-flow">await</span> watcher<span class="token punctuation">.</span><span class="token method function property-access">unwatch</span><span class="token punctuation">(</span><span class="token string">'new-file*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Stop watching.</span>
</span><span class="code-line"><span class="token comment">// The method is async!</span>
</span><span class="code-line">watcher<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Full list of options. See below for descriptions.</span>
</span><span class="code-line"><span class="token comment">// Do not use this example!</span>
</span><span class="code-line">chokidar<span class="token punctuation">.</span><span class="token method function property-access">watch</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token literal-property property">persistent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token literal-property property">ignored</span><span class="token operator">:</span> <span class="token string">'*.txt'</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">ignoreInitial</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">followSymlinks</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">cwd</span><span class="token operator">:</span> <span class="token string">'.'</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">disableGlobbing</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token literal-property property">usePolling</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">interval</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">binaryInterval</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">alwaysStat</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">depth</span><span class="token operator">:</span> <span class="token number">99</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">awaitWriteFinish</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token literal-property property">stabilityThreshold</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token literal-property property">pollInterval</span><span class="token operator">:</span> <span class="token number">100</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token literal-property property">ignorePermissionErrors</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">atomic</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// or a custom 'atomicity delay', in milliseconds (default 100)</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span></code></pre>
<p><code>chokidar.watch(paths, [options])</code></p>
<ul>
<li><code>paths</code> (string or array of strings). Paths to files, dirs to be watched
recursively, or glob patterns.
<ul>
<li>Note: globs must not contain windows separators (<code>\</code>),
because that's how they work by the standard —
you'll need to replace them with forward slashes (<code>/</code>).</li>
<li>Note 2: for additional glob documentation, check out low-level
library: <a href="https://github.com/micromatch/picomatch">picomatch</a>.</li>
</ul>
</li>
<li><code>options</code> (object) Options object as defined below:</li>
</ul>
</div></div><div class="h2wrap-body"><h4 id="persistence"><a aria-hidden="true" tabindex="-1" href="#persistence"><span class="icon icon-link"></span></a>Persistence</h4>
<ul>
<li><code>persistent</code> (default: <code>true</code>). Indicates whether the process
should continue to run as long as files are being watched. If set to
<code>false</code> when using <code>fsevents</code> to watch, no more events will be emitted
after <code>ready</code>, even if the process continues to run.</li>
</ul>
<h4 id="path-filtering"><a aria-hidden="true" tabindex="-1" href="#path-filtering"><span class="icon icon-link"></span></a>Path filtering</h4>
<ul>
<li><code>ignored</code> (<a href="https://github.com/es128/anymatch">anymatch</a>-compatible definition)
Defines files/paths to be ignored. The whole relative or absolute path is
tested, not just filename. If a function with two arguments is provided, it
gets called twice per path - once with a single argument (the path), second
time with two arguments (the path and the
<a href="https://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a>
object of that path).</li>
<li><code>ignoreInitial</code> (default: <code>false</code>). If set to <code>false</code> then <code>add</code>/<code>addDir</code> events are also emitted for matching paths while
instantiating the watching as chokidar discovers these file paths (before the <code>ready</code> event).</li>
<li><code>followSymlinks</code> (default: <code>true</code>). When <code>false</code>, only the
symlinks themselves will be watched for changes instead of following
the link references and bubbling events through the link's path.</li>
<li><code>cwd</code> (no default). The base directory from which watch <code>paths</code> are to be
derived. Paths emitted with events will be relative to this.</li>
<li><code>disableGlobbing</code> (default: <code>false</code>). If set to <code>true</code> then the strings passed to <code>.watch()</code> and <code>.add()</code> are treated as
literal path names, even if they look like globs.</li>
</ul>
<h4 id="performance"><a aria-hidden="true" tabindex="-1" href="#performance"><span class="icon icon-link"></span></a>Performance</h4>
<ul>
<li><code>usePolling</code> (default: <code>false</code>).
Whether to use fs.watchFile (backed by polling), or fs.watch. If polling
leads to high CPU utilization, consider setting this to <code>false</code>. It is
typically necessary to <strong>set this to <code>true</code> to successfully watch files over
a network</strong>, and it may be necessary to successfully watch files in other
non-standard situations. Setting to <code>true</code> explicitly on MacOS overrides the
<code>useFsEvents</code> default. You may also set the CHOKIDAR_USEPOLLING env variable
to true (1) or false (0) in order to override this option.</li>
<li><em>Polling-specific settings</em> (effective when <code>usePolling: true</code>)
<ul>
<li><code>interval</code> (default: <code>100</code>). Interval of file system polling, in milliseconds. You may also
set the CHOKIDAR_INTERVAL env variable to override this option.</li>
<li><code>binaryInterval</code> (default: <code>300</code>). Interval of file system
polling for binary files.
(<a href="https://github.com/sindresorhus/binary-extensions/blob/master/binary-extensions.json">see list of binary extensions</a>)</li>
</ul>
</li>
<li><code>useFsEvents</code> (default: <code>true</code> on MacOS). Whether to use the
<code>fsevents</code> watching interface if available. When set to <code>true</code> explicitly
and <code>fsevents</code> is available this supercedes the <code>usePolling</code> setting. When
set to <code>false</code> on MacOS, <code>usePolling: true</code> becomes the default.</li>
<li><code>alwaysStat</code> (default: <code>false</code>). If relying upon the
<a href="https://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a>
object that may get passed with <code>add</code>, <code>addDir</code>, and <code>change</code> events, set
this to <code>true</code> to ensure it is provided even in cases where it wasn't
already available from the underlying watch events.</li>
<li><code>depth</code> (default: <code>undefined</code>). If set, limits how many levels of
subdirectories will be traversed.</li>
<li><code>awaitWriteFinish</code> (default: <code>false</code>).
By default, the <code>add</code> event will fire when a file first appears on disk, before
the entire file has been written. Furthermore, in some cases some <code>change</code>
events will be emitted while the file is being written. In some cases,
especially when watching for large files there will be a need to wait for the
write operation to finish before responding to a file creation or modification.
Setting <code>awaitWriteFinish</code> to <code>true</code> (or a truthy value) will poll file size,
holding its <code>add</code> and <code>change</code> events until the size does not change for a
configurable amount of time. The appropriate duration setting is heavily
dependent on the OS and hardware. For accurate detection this parameter should
be relatively high, making file watching much less responsive.
Use with caution.
<ul>
<li><em><code>options.awaitWriteFinish</code> can be set to an object in order to adjust
timing params:</em></li>
<li><code>awaitWriteFinish.stabilityThreshold</code> (default: 2000). Amount of time in
milliseconds for a file size to remain constant before emitting its event.</li>
<li><code>awaitWriteFinish.pollInterval</code> (default: 100). File size polling interval, in milliseconds.</li>
</ul>
</li>
</ul>
<h4 id="errors"><a aria-hidden="true" tabindex="-1" href="#errors"><span class="icon icon-link"></span></a>Errors</h4>
<ul>
<li><code>ignorePermissionErrors</code> (default: <code>false</code>). Indicates whether to watch files
that don't have read permissions if possible. If watching fails due to <code>EPERM</code>
or <code>EACCES</code> with this set to <code>true</code>, the errors will be suppressed silently.</li>
<li><code>atomic</code> (default: <code>true</code> if <code>useFsEvents</code> and <code>usePolling</code> are <code>false</code>).
Automatically filters out artifacts that occur when using editors that use
"atomic writes" instead of writing directly to the source file. If a file is
re-added within 100 ms of being deleted, Chokidar emits a <code>change</code> event
rather than <code>unlink</code> then <code>add</code>. If the default of 100 ms does not work well
for you, you can override it by setting <code>atomic</code> to a custom value, in
milliseconds.</li>
</ul>
<div class="wrap h3body-not-exist"><div class="wrap-header h3wrap"><h3 id="methods--events"><a aria-hidden="true" tabindex="-1" href="#methods--events"><span class="icon icon-link"></span></a>Methods &#x26; Events</h3><div class="wrap-body">
<p><code>chokidar.watch()</code> produces an instance of <code>FSWatcher</code>. Methods of <code>FSWatcher</code>:</p>
<ul>
<li><code>.add(path / paths)</code>: Add files, directories, or glob patterns for tracking.
Takes an array of strings or just one string.</li>
<li><code>.on(event, callback)</code>: Listen for an FS event.
Available events: <code>add</code>, <code>addDir</code>, <code>change</code>, <code>unlink</code>, <code>unlinkDir</code>, <code>ready</code>,
<code>raw</code>, <code>error</code>.
Additionally <code>all</code> is available which gets emitted with the underlying event
name and path for every event other than <code>ready</code>, <code>raw</code>, and <code>error</code>.  <code>raw</code> is internal, use it carefully.</li>
<li><code>.unwatch(path / paths)</code>: Stop watching files, directories, or glob patterns.
Takes an array of strings or just one string.</li>
<li><code>.close()</code>: <strong>async</strong> Removes all listeners from watched files. Asynchronous, returns Promise. Use with <code>await</code> to ensure bugs don't happen.</li>
<li><code>.getWatched()</code>: Returns an object representing all the paths on the file
system being watched by this <code>FSWatcher</code> instance. The object's keys are all the
directories (using absolute paths unless the <code>cwd</code> option was used), and the
values are arrays of the names of the items contained in each directory.</li>
</ul>
</div></div></div></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="cli"><a aria-hidden="true" tabindex="-1" href="#cli"><span class="icon icon-link"></span></a>CLI</h2><div class="wrap-body">
<p>If you need a CLI interface for your file watching, check out
<a href="https://github.com/open-cli-tools/chokidar-cli">chokidar-cli</a>, allowing you to
execute a command on each change, or get a stdio stream of change events.</p>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="install-troubleshooting"><a aria-hidden="true" tabindex="-1" href="#install-troubleshooting"><span class="icon icon-link"></span></a>Install Troubleshooting</h2><div class="wrap-body">
<ul>
<li>
<p><code>npm WARN optional dep failed, continuing fsevents@n.n.n</code></p>
<ul>
<li>This message is normal part of how <code>npm</code> handles optional dependencies and is
not indicative of a problem. Even if accompanied by other related error messages,
Chokidar should function properly.</li>
</ul>
</li>
<li>
<p><code>TypeError: fsevents is not a constructor</code></p>
<ul>
<li>Update chokidar by doing <code>rm -rf node_modules package-lock.json yarn.lock &#x26;&#x26; npm install</code>, or update your dependency that uses chokidar.</li>
</ul>
</li>
<li>
<p>Chokidar is producing <code>ENOSP</code> error on Linux, like this:</p>
<ul>
<li><code>bash: cannot set terminal process group (-1): Inappropriate ioctl for device bash: no job control in this shell</code>
<code>Error: watch /home/ ENOSPC</code></li>
<li>This means Chokidar ran out of file handles and you'll need to increase their count by executing the following command in Terminal:
<code>echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &#x26;&#x26; sudo sysctl -p</code></li>
</ul>
</li>
</ul>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="changelog"><a aria-hidden="true" tabindex="-1" href="#changelog"><span class="icon icon-link"></span></a>Changelog</h2><div class="wrap-body">
<p>For more detailed changelog, see <a href=".github/full_changelog.html"><code>full_changelog.md</code></a>.</p>
<ul>
<li><strong>v3.5 (Jan 6, 2021):</strong> Support for ARM Macs with Apple Silicon. Fixes for deleted symlinks.</li>
<li><strong>v3.4 (Apr 26, 2020):</strong> Support for directory-based symlinks. Fixes for macos file replacement.</li>
<li><strong>v3.3 (Nov 2, 2019):</strong> <code>FSWatcher#close()</code> method became async. That fixes IO race conditions related to close method.</li>
<li><strong>v3.2 (Oct 1, 2019):</strong> Improve Linux RAM usage by 50%. Race condition fixes. Windows glob fixes. Improve stability by using tight range of dependency versions.</li>
<li><strong>v3.1 (Sep 16, 2019):</strong> dotfiles are no longer filtered out by default. Use <code>ignored</code> option if needed. Improve initial Linux scan time by 50%.</li>
<li><strong>v3 (Apr 30, 2019):</strong> massive CPU &#x26; RAM consumption improvements; reduces deps / package size by a factor of 17x and bumps Node.js requirement to v8.16 and higher.</li>
<li><strong>v2 (Dec 29, 2017):</strong> Globs are now posix-style-only; without windows support. Tons of bugfixes.</li>
<li><strong>v1 (Apr 7, 2015):</strong> Glob support, symlink support, tons of bugfixes. Node 0.8+ is supported</li>
<li><strong>v0.1 (Apr 20, 2012):</strong> Initial release, extracted from <a href="https://github.com/brunch/brunch/blob/9847a065aea300da99bd0753f90354cde9de1261/src/helpers.coffee#L66">Brunch</a></li>
</ul>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="also"><a aria-hidden="true" tabindex="-1" href="#also"><span class="icon icon-link"></span></a>Also</h2><div class="wrap-body">
<p>Why was chokidar named this way? What's the meaning behind it?</p>
<blockquote>
<p>Chowkidar is a transliteration of a Hindi word meaning 'watchman, gatekeeper', चौकीदार. This ultimately comes from Sanskrit _ चतुष्क_ (crossway, quadrangle, consisting-of-four).</p>
</blockquote>
</div></div><div class="h2wrap-body"></div></div><div class="wrap h2body-not-exist"><div class="wrap-header h2wrap"><h2 id="license"><a aria-hidden="true" tabindex="-1" href="#license"><span class="icon icon-link"></span></a>License</h2><div class="wrap-body">
<p>MIT (c) Paul Miller (<a href="https://paulmillr.com">https://paulmillr.com</a>), see <a href="LICENSE">LICENSE</a> file.</p>
</div></div><div class="h2wrap-body"></div></div></div></div><footer class="footer-wrap"><footer class="max-container">© 2022 Kenny Wang. Updated on 2022/11/17 18:48:33</footer></footer><script>
if(('onhashchange' in window) && ((typeof document.documentMode==='undefined') || document.documentMode==8)) {
  window.onhashchange = function () {
    anchorPoint()
    updateAnchor()
  };
}
function anchorPoint() {
  const hash = window.location.hash?.replace(/^#/, '') || '';
  const elm = document.getElementById(decodeURIComponent(hash));
  Array.from(document.querySelectorAll('.h2wrap-body .wrap')).forEach((elm) => elm.classList.remove('active'))
  if (elm?.tagName === 'H3') {
    elm?.parentElement?.parentElement?.classList.add('active');
  }
}
anchorPoint();

function updateAnchor(element) {
  const anchorContainer = document.querySelectorAll('.menu-tocs .menu-modal a.tocs-link');
  anchorContainer.forEach((tocanchor) => {
    tocanchor.classList.remove('is-active-link');
  });
  const anchor = element || document.querySelector(`a.tocs-link[href='${decodeURIComponent(window.location.hash)}']`);
  if (anchor) {
    anchor.classList.add('is-active-link');
  }
}
// toc 定位
updateAnchor()
const anchor = document.querySelectorAll('.menu-tocs .menu-modal a.tocs-link');
anchor.forEach((item) => {
  item.addEventListener('click', (e) => {
    updateAnchor()
  })
})
</script></body>
</html>
